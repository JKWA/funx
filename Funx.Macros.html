<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.39.3">
    <meta name="project" content="funx v0.8.3">


    <title>Funx.Macros — funx v0.8.3</title>

    <link rel="stylesheet" href="dist/html-elixir-VYWJUHZE.css" />

      <link rel="canonical" href="https://hexdocs.pm/funx/Funx.Macros.html" />

    <script defer src="dist/sidebar_items-855ABC33.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-XBCM4BHM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

      <div>
        <a href="readme.html" class="sidebar-projectName" translate="no">
funx
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v0.8.3
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-module" id="main" data-type="modules">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of funx</span>
            <div class="search-input-wrapper">
              <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
              <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
                <i class="ri-close-line ri-lg" title="Cancel search"></i>
              </button>
            </div>
          </label>
        </form>
        <div class="autocomplete">
        </div>
        <div class="engine-selector" data-multiple="false">
          <button type="button" class="engine-button" aria-label="Select search engine" aria-haspopup="true" aria-expanded="false">
            <i class="ri-search-2-line" aria-hidden="true"></i>
            <span class="engine-name">Default</span>
            <i class="ri-arrow-down-s-line" aria-hidden="true"></i>
          </button>
          <div class="engine-dropdown" hidden role="menu">

              <button type="button"
                      class="engine-option"
                      data-engine-url="search.html?q="
                      role="menuitemradio"
                      aria-checked="true">
                <span class="name">Default</span>
                <span class="help">In-browser search</span>
              </button>

          </div>
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>
      <span translate="no">Funx.Macros</span> 
      <small class="app-vsn" translate="no">(funx v0.8.3)</small>

    </h1>

      <a href="https://github.com/JKWA/funx/blob/v0.8.3/lib/macros.ex#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


    <section id="moduledoc">
<p><a href="https://livebook.dev/run?url=https%3A%2F%2Fgithub.com%2FJKWA%2Ffunx%2Fblob%2Fmain%2Flivebooks%2Fmacros%2Fmacros.livemd"><img src="https://livebook.dev/badge/v1/black.svg" alt="Run in Livebook"/></a></p><p>Provides macros for automatically implementing <a href="Funx.Eq.html"><code class="inline">Funx.Eq</code></a> and <a href="Funx.Ord.html"><code class="inline">Funx.Ord</code></a> protocols
for structs based on field projections.</p><p>The <a href="Funx.Macros.html"><code class="inline">Funx.Macros</code></a> module generates protocol implementations at compile time,
eliminating boilerplate while providing flexible projection options for both
equality and ordering comparisons. The macros support simple field access,
nested structures, optional fields, and custom projections through a unified interface.</p><p>This module is useful for:</p><ul><li>Implementing <a href="Funx.Eq.html"><code class="inline">Funx.Eq</code></a> protocol for structs with projection-based equality</li><li>Implementing <a href="Funx.Ord.html"><code class="inline">Funx.Ord</code></a> protocol with various projection strategies</li><li>Handling optional fields with safe defaults via <code class="inline">or_else</code></li><li>Accessing nested structures through Lens and Prism optics</li><li>Custom comparison logic via projection functions</li></ul><h2 id="module-macros" class="section-heading"><a href="#module-macros" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Macros</span></h2><ul><li><a href="#eq_for/2"><code class="inline">eq_for/2</code></a> - Generate <a href="Funx.Eq.html"><code class="inline">Funx.Eq</code></a> protocol implementation (basic)</li><li><a href="#eq_for/3"><code class="inline">eq_for/3</code></a> - Generate <a href="Funx.Eq.html"><code class="inline">Funx.Eq</code></a> protocol with options (e.g., <code class="inline">or_else</code>, <code class="inline">eq</code>)</li><li><a href="#ord_for/2"><code class="inline">ord_for/2</code></a> - Generate <a href="Funx.Ord.html"><code class="inline">Funx.Ord</code></a> protocol implementation (basic)</li><li><a href="#ord_for/3"><code class="inline">ord_for/3</code></a> - Generate <a href="Funx.Ord.html"><code class="inline">Funx.Ord</code></a> protocol with options (e.g., <code class="inline">or_else</code>)</li></ul><h2 id="module-projection-types" class="section-heading"><a href="#module-projection-types" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Projection Types</span></h2><p>Both <code class="inline">eq_for</code> and <code class="inline">ord_for</code> macros support multiple projection types, all normalized at compile time:</p><ul><li><strong>Atom</strong> - Converted to <code class="inline">Prism.key(atom)</code>. Safe for nil values with <code class="inline">Nothing &lt; Just</code> semantics.</li><li><strong>Atom with or_else</strong> - <code class="inline">ord_for(Struct, :field, or_else: default)</code> → <code class="inline">{Prism.key(:field), default}</code>.</li><li><strong>Lens</strong> - Total access via <code class="inline">Lens.key/1</code> or <code class="inline">Lens.path/1</code>. Raises <a href="https://hexdocs.pm/elixir/KeyError.html"><code class="inline">KeyError</code></a> on missing keys.</li><li><strong>Prism</strong> - Partial access via <code class="inline">Prism.key/1</code> or <code class="inline">Prism.path/1</code>. Returns <code class="inline">Maybe</code> with <code class="inline">Nothing &lt; Just</code> semantics.</li><li><strong>Prism with or_else</strong> - <code class="inline">ord_for(Struct, Prism.key(:field), or_else: default)</code> → <code class="inline">{prism, default}</code>.</li><li><strong>{Prism, default}</strong> - Tuple syntax for partial access with explicit fallback value.</li><li><strong>Traversal</strong> - Multiple foci via <code class="inline">Traversal.combine/1</code>. All foci must match for equality.</li><li><strong>Function</strong> - Custom projection <code class="inline">fn x -&gt; ... end</code> or <code class="inline">&amp;fun/1</code>. Must return a comparable value.</li><li><strong>Eq DSL</strong> - A pre-built equality comparator from <code class="inline">eq do ... end</code>. Used directly by <code class="inline">eq_for</code>.</li><li><strong>Ord DSL</strong> - A pre-built ordering from <code class="inline">ord do ... end</code>. Used directly by <code class="inline">ord_for</code>.</li></ul><blockquote><p>Note: Atoms use Prism by default for safety. Use explicit <code class="inline">Lens.key(:field)</code> when you need
total access that raises on missing keys or nil intermediate values.</p></blockquote><h2 id="module-or_else-option" class="section-heading"><a href="#module-or_else-option" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">or_else Option</span></h2><p>The <code class="inline">or_else</code> option provides fallback values for optional fields:</p><ul><li><strong>Valid with:</strong> Atoms, Prisms, and helper functions returning Prisms</li><li><strong>Invalid with:</strong> Lens (always returns a value), Traversal (focuses on multiple elements),
functions (must handle own defaults), struct literals, or <code class="inline">{Prism, default}</code> tuples (redundant)</li></ul><p>When <code class="inline">or_else</code> is used with an incompatible projection type, a clear compile-time
error is raised with actionable guidance.</p><h2 id="module-examples" class="section-heading"><a href="#module-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Examples</span></h2><p>Simple equality by field:</p><pre><code class="makeup elixir" translate="no"><span class="gp unselectable">iex&gt; </span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Person</span><span class="w"> </span><span class="k" data-group-id="8629405449-1">do</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="kd">defstruct</span><span class="w"> </span><span class="p" data-group-id="8629405449-2">[</span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="ss">:age</span><span class="p" data-group-id="8629405449-2">]</span><span class="w">
</span><span class="gp unselectable">...&gt;</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="kn">require</span><span class="w"> </span><span class="nc">Funx.Macros</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">eq_for</span><span class="p" data-group-id="8629405449-3">(</span><span class="nc">Person</span><span class="p">,</span><span class="w"> </span><span class="ss">:age</span><span class="p" data-group-id="8629405449-3">)</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="k" data-group-id="8629405449-1">end</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="kn">alias</span><span class="w"> </span><span class="nc">Funx.Eq</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Eq</span><span class="o">.</span><span class="n">eq?</span><span class="p" data-group-id="8629405449-4">(</span><span class="p" data-group-id="8629405449-5">%</span><span class="nc" data-group-id="8629405449-5">Person</span><span class="p" data-group-id="8629405449-5">{</span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">age</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p" data-group-id="8629405449-5">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8629405449-6">%</span><span class="nc" data-group-id="8629405449-6">Person</span><span class="p" data-group-id="8629405449-6">{</span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">age</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p" data-group-id="8629405449-6">}</span><span class="p" data-group-id="8629405449-4">)</span><span class="w">
</span><span class="no">true</span></code></pre><p>Equality with optional field:</p><pre><code class="makeup elixir" translate="no"><span class="gp unselectable">iex&gt; </span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Item</span><span class="w"> </span><span class="k" data-group-id="4386276200-1">do</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="kd">defstruct</span><span class="w"> </span><span class="p" data-group-id="4386276200-2">[</span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="ss">:score</span><span class="p" data-group-id="4386276200-2">]</span><span class="w">
</span><span class="gp unselectable">...&gt;</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="kn">require</span><span class="w"> </span><span class="nc">Funx.Macros</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">eq_for</span><span class="p" data-group-id="4386276200-3">(</span><span class="nc">Item</span><span class="p">,</span><span class="w"> </span><span class="ss">:score</span><span class="p">,</span><span class="w"> </span><span class="ss">or_else</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="4386276200-3">)</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="k" data-group-id="4386276200-1">end</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="kn">alias</span><span class="w"> </span><span class="nc">Funx.Eq</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">i1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="4386276200-4">%</span><span class="nc" data-group-id="4386276200-4">Item</span><span class="p" data-group-id="4386276200-4">{</span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">score</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="p" data-group-id="4386276200-4">}</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">i2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="4386276200-5">%</span><span class="nc" data-group-id="4386276200-5">Item</span><span class="p" data-group-id="4386276200-5">{</span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">score</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="4386276200-5">}</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Eq</span><span class="o">.</span><span class="n">eq?</span><span class="p" data-group-id="4386276200-6">(</span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="n">i2</span><span class="p" data-group-id="4386276200-6">)</span><span class="w">  </span><span class="c1"># nil becomes 0, so equal</span><span class="w">
</span><span class="no">true</span></code></pre><p>Ordering by field with Prism (safe for nil):</p><pre><code class="makeup elixir" translate="no"><span class="gp unselectable">iex&gt; </span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Product</span><span class="w"> </span><span class="k" data-group-id="9017316140-1">do</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="kd">defstruct</span><span class="w"> </span><span class="p" data-group-id="9017316140-2">[</span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="ss">:rating</span><span class="p" data-group-id="9017316140-2">]</span><span class="w">
</span><span class="gp unselectable">...&gt;</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="kn">require</span><span class="w"> </span><span class="nc">Funx.Macros</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">ord_for</span><span class="p" data-group-id="9017316140-3">(</span><span class="nc">Product</span><span class="p">,</span><span class="w"> </span><span class="ss">:rating</span><span class="p" data-group-id="9017316140-3">)</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="k" data-group-id="9017316140-1">end</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="kn">alias</span><span class="w"> </span><span class="nc">Funx.Ord</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="9017316140-4">%</span><span class="nc" data-group-id="9017316140-4">Product</span><span class="p" data-group-id="9017316140-4">{</span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Widget&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">rating</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p" data-group-id="9017316140-4">}</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="9017316140-5">%</span><span class="nc" data-group-id="9017316140-5">Product</span><span class="p" data-group-id="9017316140-5">{</span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Gadget&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">rating</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p" data-group-id="9017316140-5">}</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Ord</span><span class="o">.</span><span class="n">lt?</span><span class="p" data-group-id="9017316140-6">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p" data-group-id="9017316140-6">)</span><span class="w">
</span><span class="no">true</span></code></pre><p>Optional field with or_else:</p><pre><code class="makeup elixir" translate="no"><span class="gp unselectable">iex&gt; </span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Item</span><span class="w"> </span><span class="k" data-group-id="7716431526-1">do</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="kd">defstruct</span><span class="w"> </span><span class="p" data-group-id="7716431526-2">[</span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="ss">:score</span><span class="p" data-group-id="7716431526-2">]</span><span class="w">
</span><span class="gp unselectable">...&gt;</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="kn">require</span><span class="w"> </span><span class="nc">Funx.Macros</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">ord_for</span><span class="p" data-group-id="7716431526-3">(</span><span class="nc">Item</span><span class="p">,</span><span class="w"> </span><span class="ss">:score</span><span class="p">,</span><span class="w"> </span><span class="ss">or_else</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="7716431526-3">)</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="k" data-group-id="7716431526-1">end</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="kn">alias</span><span class="w"> </span><span class="nc">Funx.Ord</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">i1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="7716431526-4">%</span><span class="nc" data-group-id="7716431526-4">Item</span><span class="p" data-group-id="7716431526-4">{</span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">score</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="p" data-group-id="7716431526-4">}</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">i2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="7716431526-5">%</span><span class="nc" data-group-id="7716431526-5">Item</span><span class="p" data-group-id="7716431526-5">{</span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">score</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="7716431526-5">}</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Ord</span><span class="o">.</span><span class="n">lt?</span><span class="p" data-group-id="7716431526-6">(</span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="n">i2</span><span class="p" data-group-id="7716431526-6">)</span><span class="w">  </span><span class="c1"># nil becomes 0, so 0 &lt; 10</span><span class="w">
</span><span class="no">true</span></code></pre><p>Nested structure access with Lens:</p><pre><code class="makeup elixir" translate="no"><span class="gp unselectable">iex&gt; </span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Address</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="kd">defstruct</span><span class="w"> </span><span class="p" data-group-id="1091404297-1">[</span><span class="ss">:city</span><span class="p">,</span><span class="w"> </span><span class="ss">:state</span><span class="p" data-group-id="1091404297-1">]</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Customer</span><span class="w"> </span><span class="k" data-group-id="1091404297-2">do</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="kd">defstruct</span><span class="w"> </span><span class="p" data-group-id="1091404297-3">[</span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="ss">:address</span><span class="p" data-group-id="1091404297-3">]</span><span class="w">
</span><span class="gp unselectable">...&gt;</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="kn">require</span><span class="w"> </span><span class="nc">Funx.Macros</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="kn">alias</span><span class="w"> </span><span class="nc">Funx.Optics.Lens</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">ord_for</span><span class="p" data-group-id="1091404297-4">(</span><span class="nc">Customer</span><span class="p">,</span><span class="w"> </span><span class="nc">Lens</span><span class="o">.</span><span class="n">path</span><span class="p" data-group-id="1091404297-5">(</span><span class="p" data-group-id="1091404297-6">[</span><span class="ss">:address</span><span class="p">,</span><span class="w"> </span><span class="ss">:city</span><span class="p" data-group-id="1091404297-6">]</span><span class="p" data-group-id="1091404297-5">)</span><span class="p" data-group-id="1091404297-4">)</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="k" data-group-id="1091404297-2">end</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="kn">alias</span><span class="w"> </span><span class="nc">Funx.Ord</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="1091404297-7">%</span><span class="nc" data-group-id="1091404297-7">Customer</span><span class="p" data-group-id="1091404297-7">{</span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">address</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1091404297-8">%</span><span class="nc" data-group-id="1091404297-8">Address</span><span class="p" data-group-id="1091404297-8">{</span><span class="ss">city</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Austin&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">state</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TX&quot;</span><span class="p" data-group-id="1091404297-8">}</span><span class="p" data-group-id="1091404297-7">}</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="1091404297-9">%</span><span class="nc" data-group-id="1091404297-9">Customer</span><span class="p" data-group-id="1091404297-9">{</span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">address</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="1091404297-10">%</span><span class="nc" data-group-id="1091404297-10">Address</span><span class="p" data-group-id="1091404297-10">{</span><span class="ss">city</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Boston&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">state</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;MA&quot;</span><span class="p" data-group-id="1091404297-10">}</span><span class="p" data-group-id="1091404297-9">}</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Ord</span><span class="o">.</span><span class="n">lt?</span><span class="p" data-group-id="1091404297-11">(</span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p" data-group-id="1091404297-11">)</span><span class="w">  </span><span class="c1"># &quot;Austin&quot; &lt; &quot;Boston&quot;</span><span class="w">
</span><span class="no">true</span></code></pre><p>Function projection:</p><pre><code class="makeup elixir" translate="no"><span class="gp unselectable">iex&gt; </span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Article</span><span class="w"> </span><span class="k" data-group-id="7524721999-1">do</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="kd">defstruct</span><span class="w"> </span><span class="p" data-group-id="7524721999-2">[</span><span class="ss">:title</span><span class="p">,</span><span class="w"> </span><span class="ss">:content</span><span class="p" data-group-id="7524721999-2">]</span><span class="w">
</span><span class="gp unselectable">...&gt;</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="kn">require</span><span class="w"> </span><span class="nc">Funx.Macros</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">ord_for</span><span class="p" data-group-id="7524721999-3">(</span><span class="nc">Article</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">String</span><span class="o">.</span><span class="n">length</span><span class="p" data-group-id="7524721999-4">(</span><span class="ni">&amp;1</span><span class="o">.</span><span class="n">title</span><span class="p" data-group-id="7524721999-4">)</span><span class="p" data-group-id="7524721999-3">)</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="k" data-group-id="7524721999-1">end</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="kn">alias</span><span class="w"> </span><span class="nc">Funx.Ord</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="7524721999-5">%</span><span class="nc" data-group-id="7524721999-5">Article</span><span class="p" data-group-id="7524721999-5">{</span><span class="ss">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Short&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">content</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;...&quot;</span><span class="p" data-group-id="7524721999-5">}</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="7524721999-6">%</span><span class="nc" data-group-id="7524721999-6">Article</span><span class="p" data-group-id="7524721999-6">{</span><span class="ss">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Very Long Title&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">content</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;...&quot;</span><span class="p" data-group-id="7524721999-6">}</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Ord</span><span class="o">.</span><span class="n">lt?</span><span class="p" data-group-id="7524721999-7">(</span><span class="n">a1</span><span class="p">,</span><span class="w"> </span><span class="n">a2</span><span class="p" data-group-id="7524721999-7">)</span><span class="w">  </span><span class="c1"># length(&quot;Short&quot;) &lt; length(&quot;Very Long Title&quot;)</span><span class="w">
</span><span class="no">true</span></code></pre><h2 id="module-protocol-dispatch" class="section-heading"><a href="#module-protocol-dispatch" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Protocol Dispatch</span></h2><p>The generated <code class="inline">Ord</code> implementations leverage the <a href="Funx.Ord.html"><code class="inline">Funx.Ord</code></a> protocol for projected values.
Any type implementing <code class="inline">Ord</code> can be used as a projection target:</p><pre><code class="makeup elixir" translate="no"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Priority</span><span class="w"> </span><span class="k" data-group-id="3659725418-1">do</span><span class="w">
  </span><span class="kd">defstruct</span><span class="w"> </span><span class="p" data-group-id="3659725418-2">[</span><span class="ss">:level</span><span class="p" data-group-id="3659725418-2">]</span><span class="w">
</span><span class="k" data-group-id="3659725418-1">end</span><span class="w">

</span><span class="kd">defimpl</span><span class="w"> </span><span class="nc">Funx.Ord</span><span class="p">,</span><span class="w"> </span><span class="ss">for</span><span class="p">:</span><span class="w"> </span><span class="nc">Priority</span><span class="w"> </span><span class="k" data-group-id="3659725418-3">do</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">lt?</span><span class="p" data-group-id="3659725418-4">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p" data-group-id="3659725418-4">)</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">level</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">b</span><span class="o">.</span><span class="n">level</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">le?</span><span class="p" data-group-id="3659725418-5">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p" data-group-id="3659725418-5">)</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">level</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">b</span><span class="o">.</span><span class="n">level</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">gt?</span><span class="p" data-group-id="3659725418-6">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p" data-group-id="3659725418-6">)</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">level</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="o">.</span><span class="n">level</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">ge?</span><span class="p" data-group-id="3659725418-7">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p" data-group-id="3659725418-7">)</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">level</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">b</span><span class="o">.</span><span class="n">level</span><span class="w">
</span><span class="k" data-group-id="3659725418-3">end</span><span class="w">

</span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Task</span><span class="w"> </span><span class="k" data-group-id="3659725418-8">do</span><span class="w">
  </span><span class="kd">defstruct</span><span class="w"> </span><span class="p" data-group-id="3659725418-9">[</span><span class="ss">:title</span><span class="p">,</span><span class="w"> </span><span class="ss">:priority</span><span class="p" data-group-id="3659725418-9">]</span><span class="w">

  </span><span class="kn">require</span><span class="w"> </span><span class="nc">Funx.Macros</span><span class="w">
  </span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">ord_for</span><span class="p" data-group-id="3659725418-10">(</span><span class="nc">Task</span><span class="p">,</span><span class="w"> </span><span class="ss">:priority</span><span class="p" data-group-id="3659725418-10">)</span><span class="w">  </span><span class="c1"># Uses Funx.Ord.Priority</span><span class="w">
</span><span class="k" data-group-id="3659725418-8">end</span></code></pre><h2 id="module-compile-time-behavior" class="section-heading"><a href="#module-compile-time-behavior" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Compile-Time Behavior</span></h2><p>All macros expand at compile time into direct protocol implementations with zero
runtime overhead. The <code class="inline">ord_for</code> macro normalizes all projection types into one of
four canonical forms that <a href="Funx.Ord.html#contramap/2"><code class="inline">Funx.Ord.contramap/2</code></a> accepts:</p><ol><li><code class="inline">Lens.t()</code> - Bare Lens struct</li><li><code class="inline">Prism.t()</code> - Bare Prism struct (uses <code class="inline">Maybe.lift_ord</code>)</li><li><code class="inline">{Prism.t(), or_else}</code> - Prism with fallback value</li><li><code class="inline">(a -&gt; b)</code> - Projection function</li></ol><p>Example expansion:</p><pre><code class="makeup elixir" translate="no"><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">ord_for</span><span class="p" data-group-id="6727730601-1">(</span><span class="nc">Product</span><span class="p">,</span><span class="w"> </span><span class="ss">:rating</span><span class="p">,</span><span class="w"> </span><span class="ss">or_else</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="6727730601-1">)</span></code></pre><p>Compiles to:</p><pre><code class="makeup elixir" translate="no"><span class="kd">defimpl</span><span class="w"> </span><span class="nc">Funx.Ord</span><span class="p">,</span><span class="w"> </span><span class="ss">for</span><span class="p">:</span><span class="w"> </span><span class="nc">Product</span><span class="w"> </span><span class="k" data-group-id="0820229915-1">do</span><span class="w">
  </span><span class="kd">defp</span><span class="w"> </span><span class="nf">__ord_map__</span><span class="w"> </span><span class="k" data-group-id="0820229915-2">do</span><span class="w">
    </span><span class="nc">Funx.Ord</span><span class="o">.</span><span class="n">contramap</span><span class="p" data-group-id="0820229915-3">(</span><span class="p" data-group-id="0820229915-4">{</span><span class="nc">Prism</span><span class="o">.</span><span class="n">key</span><span class="p" data-group-id="0820229915-5">(</span><span class="ss">:rating</span><span class="p" data-group-id="0820229915-5">)</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="0820229915-4">}</span><span class="p" data-group-id="0820229915-3">)</span><span class="w">
  </span><span class="k" data-group-id="0820229915-2">end</span><span class="w">

  </span><span class="kd">def</span><span class="w"> </span><span class="nf">lt?</span><span class="p" data-group-id="0820229915-6">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p" data-group-id="0820229915-6">)</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">is_struct</span><span class="p" data-group-id="0820229915-7">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="nc">Product</span><span class="p" data-group-id="0820229915-7">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">is_struct</span><span class="p" data-group-id="0820229915-8">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="nc">Product</span><span class="p" data-group-id="0820229915-8">)</span><span class="w"> </span><span class="k" data-group-id="0820229915-9">do</span><span class="w">
    </span><span class="c">__ord_map__</span><span class="p" data-group-id="0820229915-10">(</span><span class="p" data-group-id="0820229915-10">)</span><span class="o">.</span><span class="n">lt?</span><span class="o">.</span><span class="p" data-group-id="0820229915-11">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p" data-group-id="0820229915-11">)</span><span class="w">
  </span><span class="k" data-group-id="0820229915-9">end</span><span class="w">
  </span><span class="c1"># ... other comparison functions</span><span class="w">
</span><span class="k" data-group-id="0820229915-1">end</span></code></pre><h2 id="module-error-handling" class="section-heading"><a href="#module-error-handling" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Error Handling</span></h2><p>The macros provide clear compile-time errors for invalid configurations:</p><ul><li>Using <code class="inline">or_else</code> with Lens (total access doesn't need fallback)</li><li>Using <code class="inline">or_else</code> with functions (functions must handle own defaults)</li><li>Using <code class="inline">or_else</code> with <code class="inline">{Prism, default}</code> tuple (redundant)</li><li>Using <code class="inline">or_else</code> with struct literals (ambiguous semantics)</li></ul><p>All error messages include actionable guidance and examples of correct usage.</p>
    </section>

</div>

  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Summary</span>
    </h1>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#eq_for/3" data-no-tooltip="" translate="no">eq_for(for_struct, projection, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Generates an implementation of the <a href="Funx.Eq.html"><code class="inline">Funx.Eq</code></a> protocol for the given struct,
using the specified projection as the basis for equality comparison.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#ord_for/3" data-no-tooltip="" translate="no">ord_for(for_struct, projection, opts \\ [])</a>

      </div>

        <div class="summary-synopsis"><p>Generates an implementation of the <a href="Funx.Ord.html"><code class="inline">Funx.Ord</code></a> protocol for the given struct,
using the specified projection as the basis for ordering comparisons.</p></div>

    </div>

</div>

  </section>


  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Functions</span>
    </h1>

    <div class="functions-list">
<section class="detail" id="eq_for/3">

    <span id="eq_for/2"></span>

  <div class="detail-header">
    <a href="#eq_for/3" class="detail-link" data-no-tooltip="" aria-label="Link to this macro">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">eq_for(for_struct, projection, opts \\ [])</h1>

        <span class="note">(macro)</span>


        <a href="https://github.com/JKWA/funx/blob/v0.8.3/lib/macros.ex#L270" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Generates an implementation of the <a href="Funx.Eq.html"><code class="inline">Funx.Eq</code></a> protocol for the given struct,
using the specified projection as the basis for equality comparison.</p><h2 id="eq_for/3-projection-types" class="section-heading"><a href="#eq_for/3-projection-types" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Projection Types</span></h2><p>The macro supports the same projection types as <code class="inline">ord_for</code>:</p><ul><li><strong>Atom</strong> - Converted to <code class="inline">Prism.key(atom)</code>. Safe for nil values.</li><li><strong>Atom with or_else</strong> - <code class="inline">eq_for(Struct, :field, or_else: default)</code> → <code class="inline">{Prism.key(:field), default}</code>.</li><li><strong>Lens</strong> - Total access via <code class="inline">Lens.key/1</code> or <code class="inline">Lens.path/1</code>. Raises on missing values.</li><li><strong>Prism</strong> - Partial access via <code class="inline">Prism.key/1</code> or <code class="inline">Prism.path/1</code>.</li><li><strong>Prism with or_else</strong> - <code class="inline">eq_for(Struct, Prism.key(:field), or_else: default)</code> → <code class="inline">{prism, default}</code>.</li><li><strong>{Prism, default}</strong> - Partial access with fallback value.</li><li><strong>Traversal</strong> - Multiple foci via <code class="inline">Traversal.combine/1</code>. All foci must match.</li><li><strong>Function</strong> - Custom projection function <code class="inline">(struct -&gt; value)</code>.</li><li><strong>Eq DSL</strong> - A pre-built equality comparator from <code class="inline">eq do ... end</code>. Used directly without contramap.</li></ul><h2 id="eq_for/3-options" class="section-heading"><a href="#eq_for/3-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Options</span></h2><ul><li><code class="inline">:or_else</code> - Fallback value for optional fields. Only valid with atoms and Prisms.</li><li><code class="inline">:eq</code> - Custom Eq module or map for comparison. Defaults to <a href="Funx.Eq.Protocol.html"><code class="inline">Funx.Eq.Protocol</code></a>.</li></ul><h2 id="eq_for/3-examples" class="section-heading"><a href="#eq_for/3-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Examples</span></h2><pre><code class="makeup elixir" translate="no"><span class="c1"># Atom (backward compatible)</span><span class="w">
</span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Person</span><span class="w"> </span><span class="k" data-group-id="0360417995-1">do</span><span class="w">
  </span><span class="kd">defstruct</span><span class="w"> </span><span class="p" data-group-id="0360417995-2">[</span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="ss">:age</span><span class="p" data-group-id="0360417995-2">]</span><span class="w">
</span><span class="k" data-group-id="0360417995-1">end</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">eq_for</span><span class="p" data-group-id="0360417995-3">(</span><span class="nc">Person</span><span class="p">,</span><span class="w"> </span><span class="ss">:age</span><span class="p" data-group-id="0360417995-3">)</span><span class="w">

</span><span class="c1"># Atom with or_else</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">eq_for</span><span class="p" data-group-id="0360417995-4">(</span><span class="nc">Person</span><span class="p">,</span><span class="w"> </span><span class="ss">:score</span><span class="p">,</span><span class="w"> </span><span class="ss">or_else</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="0360417995-4">)</span><span class="w">

</span><span class="c1"># Lens - total access</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">eq_for</span><span class="p" data-group-id="0360417995-5">(</span><span class="nc">Customer</span><span class="p">,</span><span class="w"> </span><span class="nc">Lens</span><span class="o">.</span><span class="n">path</span><span class="p" data-group-id="0360417995-6">(</span><span class="p" data-group-id="0360417995-7">[</span><span class="ss">:address</span><span class="p">,</span><span class="w"> </span><span class="ss">:city</span><span class="p" data-group-id="0360417995-7">]</span><span class="p" data-group-id="0360417995-6">)</span><span class="p" data-group-id="0360417995-5">)</span><span class="w">

</span><span class="c1"># Prism - partial access</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">eq_for</span><span class="p" data-group-id="0360417995-8">(</span><span class="nc">Item</span><span class="p">,</span><span class="w"> </span><span class="nc">Prism</span><span class="o">.</span><span class="n">key</span><span class="p" data-group-id="0360417995-9">(</span><span class="ss">:rating</span><span class="p" data-group-id="0360417995-9">)</span><span class="p" data-group-id="0360417995-8">)</span><span class="w">

</span><span class="c1"># Traversal - multiple foci</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">eq_for</span><span class="p" data-group-id="0360417995-10">(</span><span class="nc">Person</span><span class="p">,</span><span class="w"> </span><span class="nc">Traversal</span><span class="o">.</span><span class="n">combine</span><span class="p" data-group-id="0360417995-11">(</span><span class="p" data-group-id="0360417995-12">[</span><span class="nc">Lens</span><span class="o">.</span><span class="n">key</span><span class="p" data-group-id="0360417995-13">(</span><span class="ss">:name</span><span class="p" data-group-id="0360417995-13">)</span><span class="p">,</span><span class="w"> </span><span class="nc">Lens</span><span class="o">.</span><span class="n">key</span><span class="p" data-group-id="0360417995-14">(</span><span class="ss">:age</span><span class="p" data-group-id="0360417995-14">)</span><span class="p" data-group-id="0360417995-12">]</span><span class="p" data-group-id="0360417995-11">)</span><span class="p" data-group-id="0360417995-10">)</span><span class="w">

</span><span class="c1"># Function projection</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">eq_for</span><span class="p" data-group-id="0360417995-15">(</span><span class="nc">Article</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">String</span><span class="o">.</span><span class="n">length</span><span class="p" data-group-id="0360417995-16">(</span><span class="ni">&amp;1</span><span class="o">.</span><span class="n">title</span><span class="p" data-group-id="0360417995-16">)</span><span class="p" data-group-id="0360417995-15">)</span><span class="w">

</span><span class="c1"># Custom Eq module</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">eq_for</span><span class="p" data-group-id="0360417995-17">(</span><span class="nc">Person</span><span class="p">,</span><span class="w"> </span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="ss">eq</span><span class="p">:</span><span class="w"> </span><span class="nc">CaseInsensitiveEq</span><span class="p" data-group-id="0360417995-17">)</span><span class="w">

</span><span class="c1"># Eq DSL - complex equality with multiple fields</span><span class="w">
</span><span class="kn">use</span><span class="w"> </span><span class="nc">Funx.Eq</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">eq_for</span><span class="p" data-group-id="0360417995-18">(</span><span class="nc">Person</span><span class="p">,</span><span class="w"> </span><span class="n">eq</span><span class="w"> </span><span class="k" data-group-id="0360417995-19">do</span><span class="w">
  </span><span class="n">on</span><span class="w"> </span><span class="ss">:name</span><span class="w">
  </span><span class="n">on</span><span class="w"> </span><span class="ss">:age</span><span class="w">
</span><span class="k" data-group-id="0360417995-19">end</span><span class="p" data-group-id="0360417995-18">)</span></code></pre>
  </section>
</section>
<section class="detail" id="ord_for/3">

    <span id="ord_for/2"></span>

  <div class="detail-header">
    <a href="#ord_for/3" class="detail-link" data-no-tooltip="" aria-label="Link to this macro">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">ord_for(for_struct, projection, opts \\ [])</h1>

        <span class="note">(macro)</span>


        <a href="https://github.com/JKWA/funx/blob/v0.8.3/lib/macros.ex#L365" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

<p>Generates an implementation of the <a href="Funx.Ord.html"><code class="inline">Funx.Ord</code></a> protocol for the given struct,
using the specified projection as the basis for ordering comparisons.</p><h2 id="ord_for/3-projection-types" class="section-heading"><a href="#ord_for/3-projection-types" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Projection Types</span></h2><p>The macro supports multiple projection types:</p><ul><li><strong>Atom</strong> - Converted to <code class="inline">Prism.key(atom)</code>. Safe for nil values (Nothing &lt; Just).</li><li><strong>Atom with or_else</strong> - <code class="inline">ord_for(Struct, :field, or_else: default)</code> → <code class="inline">{Prism.key(:field), default}</code>.</li><li><strong>Lens</strong> - Total access via <code class="inline">Lens.key/1</code> or <code class="inline">Lens.path/1</code>. Raises on missing values.</li><li><strong>Prism</strong> - Partial access via <code class="inline">Prism.key/1</code> or <code class="inline">Prism.path/1</code>. Nothing &lt; Just semantics.</li><li><strong>Prism with or_else</strong> - <code class="inline">ord_for(Struct, Prism.key(:field), or_else: default)</code> → <code class="inline">{prism, default}</code>.</li><li><strong>{Prism, default}</strong> - Partial access with fallback value for Nothing.</li><li><strong>Function</strong> - Custom projection function <code class="inline">(struct -&gt; comparable)</code>.</li><li><strong>Ord DSL</strong> - A pre-built ordering from <code class="inline">ord do ... end</code>. Used directly without contramap.</li></ul><h2 id="ord_for/3-options" class="section-heading"><a href="#ord_for/3-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Options</span></h2><ul><li><code class="inline">:or_else</code> - Fallback value for optional fields. Only valid with atoms and Prisms.</li><li><code class="inline">:ord</code> - Custom Ord module or map for comparison. Defaults to <a href="Funx.Ord.Protocol.html"><code class="inline">Funx.Ord.Protocol</code></a>.</li></ul><h2 id="ord_for/3-examples" class="section-heading"><a href="#ord_for/3-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Examples</span></h2><pre><code class="makeup elixir" translate="no"><span class="c1"># Atom - uses Prism.key (safe for nil)</span><span class="w">
</span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Product</span><span class="w"> </span><span class="k" data-group-id="1363033774-1">do</span><span class="w">
  </span><span class="kd">defstruct</span><span class="w"> </span><span class="p" data-group-id="1363033774-2">[</span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="ss">:rating</span><span class="p" data-group-id="1363033774-2">]</span><span class="w">
</span><span class="k" data-group-id="1363033774-1">end</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">ord_for</span><span class="p" data-group-id="1363033774-3">(</span><span class="nc">Product</span><span class="p">,</span><span class="w"> </span><span class="ss">:rating</span><span class="p" data-group-id="1363033774-3">)</span><span class="w">

</span><span class="c1"># Atom with or_else - provides default for nil values</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">ord_for</span><span class="p" data-group-id="1363033774-4">(</span><span class="nc">Product</span><span class="p">,</span><span class="w"> </span><span class="ss">:rating</span><span class="p">,</span><span class="w"> </span><span class="ss">or_else</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1363033774-4">)</span><span class="w">

</span><span class="c1"># Lens - total access (raises on nil)</span><span class="w">
</span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Customer</span><span class="w"> </span><span class="k" data-group-id="1363033774-5">do</span><span class="w">
  </span><span class="kd">defstruct</span><span class="w"> </span><span class="p" data-group-id="1363033774-6">[</span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="ss">:address</span><span class="p" data-group-id="1363033774-6">]</span><span class="w">
</span><span class="k" data-group-id="1363033774-5">end</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">ord_for</span><span class="p" data-group-id="1363033774-7">(</span><span class="nc">Customer</span><span class="p">,</span><span class="w"> </span><span class="nc">Lens</span><span class="o">.</span><span class="n">path</span><span class="p" data-group-id="1363033774-8">(</span><span class="p" data-group-id="1363033774-9">[</span><span class="ss">:address</span><span class="p">,</span><span class="w"> </span><span class="ss">:city</span><span class="p" data-group-id="1363033774-9">]</span><span class="p" data-group-id="1363033774-8">)</span><span class="p" data-group-id="1363033774-7">)</span><span class="w">

</span><span class="c1"># Prism - partial access</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">ord_for</span><span class="p" data-group-id="1363033774-10">(</span><span class="nc">Item</span><span class="p">,</span><span class="w"> </span><span class="nc">Prism</span><span class="o">.</span><span class="n">key</span><span class="p" data-group-id="1363033774-11">(</span><span class="ss">:score</span><span class="p" data-group-id="1363033774-11">)</span><span class="p" data-group-id="1363033774-10">)</span><span class="w">

</span><span class="c1"># Prism with or_else</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">ord_for</span><span class="p" data-group-id="1363033774-12">(</span><span class="nc">Item</span><span class="p">,</span><span class="w"> </span><span class="nc">Prism</span><span class="o">.</span><span class="n">key</span><span class="p" data-group-id="1363033774-13">(</span><span class="ss">:score</span><span class="p" data-group-id="1363033774-13">)</span><span class="p">,</span><span class="w"> </span><span class="ss">or_else</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1363033774-12">)</span><span class="w">

</span><span class="c1"># Prism with default tuple (alternative to or_else)</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">ord_for</span><span class="p" data-group-id="1363033774-14">(</span><span class="nc">Task</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1363033774-15">{</span><span class="nc">Prism</span><span class="o">.</span><span class="n">key</span><span class="p" data-group-id="1363033774-16">(</span><span class="ss">:priority</span><span class="p" data-group-id="1363033774-16">)</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1363033774-15">}</span><span class="p" data-group-id="1363033774-14">)</span><span class="w">

</span><span class="c1"># Function projection</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">ord_for</span><span class="p" data-group-id="1363033774-17">(</span><span class="nc">Article</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">String</span><span class="o">.</span><span class="n">length</span><span class="p" data-group-id="1363033774-18">(</span><span class="ni">&amp;1</span><span class="o">.</span><span class="n">title</span><span class="p" data-group-id="1363033774-18">)</span><span class="p" data-group-id="1363033774-17">)</span><span class="w">

</span><span class="c1"># Ord DSL - complex ordering with multiple fields</span><span class="w">
</span><span class="kn">use</span><span class="w"> </span><span class="nc">Funx.Ord</span><span class="w">
</span><span class="nc">Funx.Macros</span><span class="o">.</span><span class="n">ord_for</span><span class="p" data-group-id="1363033774-19">(</span><span class="nc">Person</span><span class="p">,</span><span class="w"> </span><span class="n">ord</span><span class="w"> </span><span class="k" data-group-id="1363033774-20">do</span><span class="w">
  </span><span class="n">asc</span><span class="w"> </span><span class="ss">:name</span><span class="w">
  </span><span class="n">desc</span><span class="w"> </span><span class="ss">:age</span><span class="w">
</span><span class="k" data-group-id="1363033774-20">end</span><span class="p" data-group-id="1363033774-19">)</span></code></pre>
  </section>
</section>

    </div>
  </section>

    <footer class="footer">

        <p>

            <span class="line">
              <a href="https://hex.pm/packages/funx/0.8.3" class="footer-hex-package">Hex Package</a>

              <a href="https://preview.hex.pm/preview/funx/0.8.3">Hex Preview</a>

            </span>

          <span class="line">
            <button class="a-main footer-button display-quick-switch" title="Go to package docs">
              Go to package docs
            </button>

              <a href="funx.epub" title="ePub version">
                Download ePub version
              </a>

          </span>
        </p>

        <p class="built-using">
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.39.3) for the

            <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

        </p>


    </footer>
  </div>
</main>
</div>

  </body>
</html>
