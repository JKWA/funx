<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.34.2">
    <meta name="project" content="funx v0.1.4">


    <title>Funx.Monad Usage Rules — funx v0.1.4</title>
    <link rel="stylesheet" href="dist/html-elixir-F2VRIOKR.css" />


      <link rel="canonical" href="https://hexdocs.pm/funx/monad-usage-rules.html" />

    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-K7URE6B4.js"></script>
    <script src="dist/sidebar_items-BB212813.js"></script>
    <script src="docs_config.js"></script>
    <script async src="dist/html-YIPIRHGU.js"></script>

  </head>
  <body data-type="extras" class="page-extra">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

      <div>
        <a href="readme.html" class="sidebar-projectName" translate="no">
funx
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v0.1.4
        </div>
      </div>
    </div>
    <ul id="sidebar-listNav" class="sidebar-listNav" role="tablist">
      <li>
        <button id="extras-list-tab-button" role="tab" data-type="extras" aria-controls="extras-tab-panel" aria-selected="true" tabindex="0">
Pages
        </button>
      </li>

        <li>
          <button id="modules-list-tab-button" role="tab" data-type="modules" aria-controls="modules-tab-panel" aria-selected="false" tabindex="-1">
            Modules
          </button>
        </li>


    </ul>
  </div>

  <div id="extras-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="extras-list-tab-button">
    <ul id="extras-full-list" class="full-list"></ul>
  </div>

    <div id="modules-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="modules-list-tab-button" hidden>
      <ul id="modules-full-list" class="full-list"></ul>
    </div>


</nav>

<main class="content">
  <output role="status" id="toast"></output>

  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of funx</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search">
            <i class="ri-search-2-line ri-lg" aria-hidden="true" title="Submit search"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <h1>

      <a href="https://github.com/JKWA/funx/blob/v0.1.4/lib/monad/usage-rules.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>


    <span><code class="inline">Funx.Monad</code> Usage Rules</span>
  </h1>

<h2 id="llm-functional-programming-foundation" class="section-heading">
  <a href="#llm-functional-programming-foundation" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">LLM Functional Programming Foundation</span>
</h2>
<p><strong>Key Concepts for LLMs:</strong></p><p><strong>Monad</strong>: A design pattern that provides a structured way to handle computations with context</p><ul><li><strong>Bind operation</strong>: Chains computations that might fail, transform, or have side effects</li><li><strong>Map operation</strong>: Transforms the wrapped value with a regular function</li><li><strong>Mathematical foundation</strong>: Satisfies identity and associativity laws</li><li><strong>Three fundamental operations</strong>: <code class="inline">bind/2</code>, <code class="inline">map/2</code>, and <code class="inline">ap/2</code></li></ul><p><strong>Kleisli Functions</strong>: Functions that return values wrapped in a monadic context</p><ul><li>Type signature: <code class="inline">a -&gt; M&lt;b&gt;</code> (takes regular value, returns monadic value)</li><li>Compose with <code class="inline">bind/2</code> rather than regular function composition</li><li>Enable chaining of operations that might fail or transform context</li><li>Example: <code class="inline">fn x -&gt; {:ok, x * 2} end</code> is a Kleisli function for Result monad</li></ul><p><strong>Monadic vs. Applicative</strong>: Different styles for handling multiple wrapped values</p><ul><li><strong>Monadic (sequential)</strong>: Later computations depend on earlier results</li><li><strong>Applicative (independent)</strong>: All computations are independent and can run in parallel</li><li><strong>Rule</strong>: Use monadic when you need the result of one computation to determine the next</li></ul><p><strong>Bind vs. Map</strong>: Different operations for different transformations</p><ul><li><strong>Map</strong>: Transform the value inside the monad (<code class="inline">a -&gt; b</code> functions)</li><li><strong>Bind</strong>: Chain monadic operations (<code class="inline">a -&gt; M&lt;b&gt;</code> functions)</li><li><strong>Key insight</strong>: Bind flattens nested monads, map doesn't</li></ul><p><strong>Context Preservation</strong>: Monads maintain computational context through transformations</p><ul><li><strong>Maybe monad</strong>: Preserves presence/absence context</li><li><strong>Either monad</strong>: Preserves success/failure with error information</li><li><strong>Identity monad</strong>: Transparent context for learning and composition</li><li><strong>Context flows</strong>: Through bind chains automatically</li></ul><h2 id="llm-decision-guide-when-to-use-monad-protocol" class="section-heading">
  <a href="#llm-decision-guide-when-to-use-monad-protocol" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">LLM Decision Guide: When to Use Monad Protocol</span>
</h2>
<p><strong>✅ Use Monad Protocol when:</strong></p><ul><li>Building generic functions that work with any monad</li><li>Creating monad-agnostic algorithms</li><li>Need to compose different monadic operations</li><li>Want polymorphic code that works with Maybe, Either, Identity, etc.</li><li>User says: &quot;generic&quot;, &quot;polymorphic&quot;, &quot;works with any monad&quot;, &quot;monad-agnostic&quot;</li></ul><p><strong>❌ Don't use Protocol when:</strong></p><ul><li>Working with specific monad types only</li><li>Performance is critical (protocol dispatch has overhead)</li><li>Simple transformations that don't need genericity</li><li>User is asking for specific Maybe or Either operations</li></ul><p><strong>⚡ Protocol vs. Direct Module Decision:</strong></p><ul><li><strong>Protocol</strong>: Generic code that works with multiple monad types</li><li><strong>Direct module</strong>: Type-specific optimized operations</li><li><strong>Rule</strong>: Start with direct modules, extract to protocol when you need genericity</li></ul><p><strong>⚙️ Operation Choice Guide:</strong></p><ul><li><strong>bind/2</strong>: Chain operations that return monadic values</li><li><strong>map/2</strong>: Transform values inside the monadic context</li><li><strong>ap/2</strong>: Apply functions in monadic context to values in monadic context</li><li><strong>Law verification</strong>: Always test monad laws in generic code</li></ul><h2 id="llm-context-clues" class="section-heading">
  <a href="#llm-context-clues" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">LLM Context Clues</span>
</h2>
<p><strong>User language → Monad protocol patterns:</strong></p><ul><li>&quot;generic monad function&quot; → Use protocol operations</li><li>&quot;works with any monad&quot; → Protocol-based implementation</li><li>&quot;polymorphic over monads&quot; → Protocol with type constraints</li><li>&quot;chain operations&quot; → <code class="inline">bind/2</code> sequences</li><li>&quot;transform value&quot; → <code class="inline">map/2</code></li><li>&quot;apply function&quot; → <code class="inline">ap/2</code></li><li>&quot;sequence computations&quot; → Bind chains with error handling</li><li>&quot;monad laws&quot; → Identity and associativity verification</li></ul><h2 id="quick-reference" class="section-heading">
  <a href="#quick-reference" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Quick Reference</span>
</h2>
<ul><li>Use <code class="inline">bind/2</code> to chain Kleisli functions (operations returning monadic values)</li><li>Use <code class="inline">map/2</code> to transform values inside the monadic context</li><li>Use <code class="inline">ap/2</code> for applicative style when computations are independent</li><li>Use constructor functions like <code class="inline">Maybe.just/1</code>, <code class="inline">Either.right/1</code> to create monadic values</li><li>Use <code class="inline">bind/2</code> to naturally flatten nested monads through composition</li><li>All monads support <code class="inline">map/2</code> and <code class="inline">ap/2</code> via protocol or import</li><li>Monad laws: left identity, right identity, associativity</li><li>Protocol enables polymorphic functions working across monad types</li></ul><h2 id="overview" class="section-heading">
  <a href="#overview" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Overview</span>
</h2>
<p><a href="Funx.Monad.html"><code class="inline">Funx.Monad</code></a> defines the core protocol for monadic operations in Elixir. It provides the essential operations that all monads must implement: <code class="inline">bind/2</code>, <code class="inline">map/2</code>, and <code class="inline">ap/2</code>. This protocol enables writing generic, reusable functions that work with any monadic type.</p><p>The protocol is the foundation for functional composition patterns, enabling you to chain computations while preserving context (whether that's handling optional values, errors, transformations, or other computational contexts).</p><h2 id="protocol-operations" class="section-heading">
  <a href="#protocol-operations" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Protocol Operations</span>
</h2>
<table><thead><tr><th style="text-align: left;">Operation</th><th style="text-align: left;">Type Signature</th><th style="text-align: left;">Purpose</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">bind/2</code></td><td style="text-align: left;"><code class="inline">M&lt;a&gt; -&gt; (a -&gt; M&lt;b&gt;) -&gt; M&lt;b&gt;</code></td><td style="text-align: left;">Chain monadic computations</td></tr><tr><td style="text-align: left;"><code class="inline">map/2</code></td><td style="text-align: left;"><code class="inline">M&lt;a&gt; -&gt; (a -&gt; b) -&gt; M&lt;b&gt;</code></td><td style="text-align: left;">Transform the wrapped value</td></tr><tr><td style="text-align: left;"><code class="inline">ap/2</code></td><td style="text-align: left;"><code class="inline">M&lt;(a -&gt; b)&gt; -&gt; M&lt;a&gt; -&gt; M&lt;b&gt;</code></td><td style="text-align: left;">Apply a wrapped function to wrapped value</td></tr></tbody></table><p>The protocol requires implementing three operations: <code class="inline">bind/2</code> for chaining monadic functions, <code class="inline">map/2</code> for transforming wrapped values, and <code class="inline">ap/2</code> for applicative-style function application.</p><h2 id="llm-monad-laws-foundation" class="section-heading">
  <a href="#llm-monad-laws-foundation" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">LLM Monad Laws Foundation</span>
</h2>
<p><strong>Mathematical Requirements:</strong></p><p>All monad implementations must satisfy three fundamental laws:</p><p><strong>Left Identity</strong>: <code class="inline">Constructor.new(a) |&gt; bind(f) == f.(a)</code></p><ul><li>Creating a monad then binding should equal direct application</li><li>The monadic wrapper doesn't interfere with computation</li></ul><p><strong>Right Identity</strong>: <code class="inline">m |&gt; bind(fn x -&gt; Constructor.new(x) end) == m</code>  </p><ul><li>Binding with constructor should leave the monad unchanged</li><li>Constructor functions are neutral elements for bind</li></ul><p><strong>Associativity</strong>: <code class="inline">(m |&gt; bind(f)) |&gt; bind(g) == m |&gt; bind(fn x -&gt; bind(f.(x), g) end)</code></p><ul><li>Order of binding operations doesn't matter</li><li>Enables reliable composition and refactoring</li></ul><p><strong>Why Laws Matter for LLMs:</strong></p><ul><li><strong>Predictability</strong>: Laws ensure consistent behavior across implementations</li><li><strong>Composition safety</strong>: Can refactor and compose without breaking semantics  </li><li><strong>Generic algorithms</strong>: Enable writing functions that work with any lawful monad</li><li><strong>Debugging confidence</strong>: Law violations indicate implementation bugs</li></ul><h2 id="usage-patterns" class="section-heading">
  <a href="#usage-patterns" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Usage Patterns</span>
</h2>
<h3 id="basic-monadic-pipeline" class="section-heading">
  <a href="#basic-monadic-pipeline" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Basic Monadic Pipeline</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="c1"># Generic function working with any monad</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">transform_generically</span><span class="p" data-group-id="8827863621-1">(</span><span class="n">monad_value</span><span class="p" data-group-id="8827863621-1">)</span><span class="w"> </span><span class="k" data-group-id="8827863621-2">do</span><span class="w">
  </span><span class="n">monad_value</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="8827863621-3">(</span><span class="k" data-group-id="8827863621-4">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="8827863621-5">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x * 2) end)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="8827863621-6">(</span><span class="k" data-group-id="8827863621-7">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="8827863621-8">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x + 1) end)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="8827863621-9">(</span><span class="k" data-group-id="8827863621-10">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> 
    </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k" data-group-id="8827863621-11">do</span><span class="w">
      </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="8827863621-12">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.&quot;large: #{x}&quot;)</span><span class="w">
    </span><span class="k">else</span><span class="w">
      </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="8827863621-13">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.&quot;small: #{x}&quot;)</span><span class="w">
    </span><span class="k">end</span><span class="w">
  </span><span class="k">end</span><span class="p" data-group-id="8827863621-13">)</span><span class="w">
</span><span class="k">end</span><span class="w">

</span><span class="c1"># Works with Maybe</span><span class="w">
</span><span class="n">transform_generically</span><span class="p" data-group-id="8827863621-14">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="8827863621-15">(</span><span class="mi">5</span><span class="p" data-group-id="8827863621-15">)</span><span class="p" data-group-id="8827863621-14">)</span><span class="w">    </span><span class="c1"># =&gt; Just(&quot;large: 11&quot;) </span><span class="w">
</span><span class="n">transform_generically</span><span class="p" data-group-id="8827863621-16">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="8827863621-17">(</span><span class="p" data-group-id="8827863621-17">)</span><span class="p" data-group-id="8827863621-16">)</span><span class="w">  </span><span class="c1"># =&gt; Nothing</span><span class="w">

</span><span class="c1"># Works with Either  </span><span class="w">
</span><span class="n">transform_generically</span><span class="p" data-group-id="8827863621-18">(</span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="8827863621-19">(</span><span class="mi">5</span><span class="p" data-group-id="8827863621-19">)</span><span class="p" data-group-id="8827863621-18">)</span><span class="w">  </span><span class="c1"># =&gt; Right(&quot;large: 11&quot;)</span><span class="w">
</span><span class="n">transform_generically</span><span class="p" data-group-id="8827863621-20">(</span><span class="nc">Either</span><span class="o">.</span><span class="n">left</span><span class="p" data-group-id="8827863621-21">(</span><span class="s">&quot;error&quot;</span><span class="p" data-group-id="8827863621-21">)</span><span class="p" data-group-id="8827863621-20">)</span><span class="w"> </span><span class="c1"># =&gt; Left(&quot;error&quot;)</span></code></pre><h3 id="kleisli-function-composition" class="section-heading">
  <a href="#kleisli-function-composition" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Kleisli Function Composition</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="c1"># Kleisli functions for various monads</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">safe_divide</span><span class="p" data-group-id="1801031899-1">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p" data-group-id="1801031899-1">)</span><span class="w"> </span><span class="k" data-group-id="1801031899-2">do</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="1801031899-3">do</span><span class="w">
    </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="1801031899-4">(</span><span class="n">a</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">b</span><span class="p" data-group-id="1801031899-4">)</span><span class="w">
  </span><span class="k" data-group-id="1801031899-3">else</span><span class="w">
    </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="1801031899-5">(</span><span class="p" data-group-id="1801031899-5">)</span><span class="w">
  </span><span class="k" data-group-id="1801031899-3">end</span><span class="w">
</span><span class="k" data-group-id="1801031899-2">end</span><span class="w">

</span><span class="kd">def</span><span class="w"> </span><span class="nf">validate_positive</span><span class="p" data-group-id="1801031899-6">(</span><span class="n">x</span><span class="p" data-group-id="1801031899-6">)</span><span class="w"> </span><span class="k" data-group-id="1801031899-7">do</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="1801031899-8">do</span><span class="w">
    </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="1801031899-9">(</span><span class="n">x</span><span class="p" data-group-id="1801031899-9">)</span><span class="w">
  </span><span class="k" data-group-id="1801031899-8">else</span><span class="w">
    </span><span class="nc">Either</span><span class="o">.</span><span class="n">left</span><span class="p" data-group-id="1801031899-10">(</span><span class="s">&quot;must be positive&quot;</span><span class="p" data-group-id="1801031899-10">)</span><span class="w">
  </span><span class="k" data-group-id="1801031899-8">end</span><span class="w">
</span><span class="k" data-group-id="1801031899-7">end</span><span class="w">

</span><span class="c1"># Generic composition using protocol</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">compose_kleisli</span><span class="p" data-group-id="1801031899-11">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">kleisli_fns</span><span class="p" data-group-id="1801031899-11">)</span><span class="w"> </span><span class="k" data-group-id="1801031899-12">do</span><span class="w">
  </span><span class="nc">Enum</span><span class="o">.</span><span class="n">reduce</span><span class="p" data-group-id="1801031899-13">(</span><span class="n">kleisli_fns</span><span class="p">,</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="1801031899-14">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.value), fn f, acc -&gt;</span><span class="w">
    </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1801031899-15">(</span><span class="n">acc</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p" data-group-id="1801031899-15">)</span><span class="w">
  </span><span class="k">end</span><span class="p" data-group-id="1801031899-14">)</span><span class="w">
</span><span class="k">end</span><span class="w">

</span><span class="c1"># Use with different monads</span><span class="w">
</span><span class="n">compose_kleisli</span><span class="p" data-group-id="1801031899-16">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1801031899-17">[</span><span class="n">safe_divide</span><span class="p" data-group-id="1801031899-18">(</span><span class="mi">20</span><span class="p" data-group-id="1801031899-18">)</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="1801031899-19">(</span><span class="ni">&amp;1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1801031899-19">)</span><span class="p" data-group-id="1801031899-17">]</span><span class="p" data-group-id="1801031899-16">)</span><span class="w">
</span><span class="n">compose_kleisli</span><span class="p" data-group-id="1801031899-20">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1801031899-21">[</span><span class="n">validate_positive</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="1801031899-22">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="1801031899-23">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="1801031899-23">)</span><span class="w"> </span><span class="k" data-group-id="1801031899-22">end</span><span class="p" data-group-id="1801031899-21">]</span><span class="p" data-group-id="1801031899-20">)</span></code></pre><h3 id="map-for-transforming-values" class="section-heading">
  <a href="#map-for-transforming-values" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Map for Transforming Values</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="c1"># Transform values inside monadic context</span><span class="w">
</span><span class="kn">import</span><span class="w"> </span><span class="nc">Funx.Monad</span><span class="w">

</span><span class="c1"># Works with any monad</span><span class="w">
</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="5064059522-1">(</span><span class="mi">5</span><span class="p" data-group-id="5064059522-1">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">map</span><span class="p" data-group-id="5064059522-2">(</span><span class="o">&amp;</span><span class="p" data-group-id="5064059522-3">(</span><span class="ni">&amp;1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="5064059522-3">)</span><span class="p" data-group-id="5064059522-2">)</span><span class="w">      </span><span class="c1"># Just(10)</span><span class="w">
</span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="5064059522-4">(</span><span class="mi">5</span><span class="p" data-group-id="5064059522-4">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">map</span><span class="p" data-group-id="5064059522-5">(</span><span class="o">&amp;</span><span class="p" data-group-id="5064059522-6">(</span><span class="ni">&amp;1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="5064059522-6">)</span><span class="p" data-group-id="5064059522-5">)</span><span class="w">    </span><span class="c1"># Right(10)</span><span class="w">
</span><span class="nc">Identity</span><span class="o">.</span><span class="n">identity</span><span class="p" data-group-id="5064059522-7">(</span><span class="mi">5</span><span class="p" data-group-id="5064059522-7">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">map</span><span class="p" data-group-id="5064059522-8">(</span><span class="o">&amp;</span><span class="p" data-group-id="5064059522-9">(</span><span class="ni">&amp;1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="5064059522-9">)</span><span class="p" data-group-id="5064059522-8">)</span><span class="w"> </span><span class="c1"># Identity(10)</span><span class="w">

</span><span class="c1"># Chain transformations</span><span class="w">
</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="5064059522-10">(</span><span class="s">&quot;hello&quot;</span><span class="p" data-group-id="5064059522-10">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">map</span><span class="p" data-group-id="5064059522-11">(</span><span class="o">&amp;</span><span class="nc">String</span><span class="o">.</span><span class="n">upcase</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="5064059522-11">)</span><span class="w">              </span><span class="c1"># Just(&quot;HELLO&quot;)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">map</span><span class="p" data-group-id="5064059522-12">(</span><span class="o">&amp;</span><span class="nc">String</span><span class="o">.</span><span class="n">length</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="5064059522-12">)</span><span class="w">              </span><span class="c1"># Just(5)</span></code></pre><h3 id="ap-for-applying-wrapped-functions" class="section-heading">
  <a href="#ap-for-applying-wrapped-functions" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Ap for Applying Wrapped Functions</span>
</h3>
<p>Applies a monadic function (e.g., <code class="inline">M&lt;(a -&gt; b)&gt;</code>) to a monadic argument (<code class="inline">M&lt;a&gt;</code>), returning <code class="inline">M&lt;b&gt;</code>. This enables applicative style when computations are independent.</p><pre><code class="makeup elixir" translate="no"><span class="kn">import</span><span class="w"> </span><span class="nc">Funx.Monad</span><span class="w">

</span><span class="c1"># Basic function application</span><span class="w">
</span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="5402327215-1">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k" data-group-id="5402327215-2">fn</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="k" data-group-id="5402327215-2">end</span><span class="w"> </span><span class="k" data-group-id="5402327215-1">end</span><span class="w">

</span><span class="n">return</span><span class="p" data-group-id="5402327215-3">(</span><span class="n">add</span><span class="p" data-group-id="5402327215-3">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">ap</span><span class="p" data-group-id="5402327215-4">(</span><span class="n">return</span><span class="p" data-group-id="5402327215-5">(</span><span class="mi">3</span><span class="p" data-group-id="5402327215-5">)</span><span class="p" data-group-id="5402327215-4">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">ap</span><span class="p" data-group-id="5402327215-6">(</span><span class="n">return</span><span class="p" data-group-id="5402327215-7">(</span><span class="mi">4</span><span class="p" data-group-id="5402327215-7">)</span><span class="p" data-group-id="5402327215-6">)</span><span class="w">                     </span><span class="c1"># Works with any monad</span><span class="w">

</span><span class="c1"># With Maybe</span><span class="w">
</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="5402327215-8">(</span><span class="n">add</span><span class="p" data-group-id="5402327215-8">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">ap</span><span class="p" data-group-id="5402327215-9">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="5402327215-10">(</span><span class="mi">3</span><span class="p" data-group-id="5402327215-10">)</span><span class="p" data-group-id="5402327215-9">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">ap</span><span class="p" data-group-id="5402327215-11">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="5402327215-12">(</span><span class="mi">4</span><span class="p" data-group-id="5402327215-12">)</span><span class="p" data-group-id="5402327215-11">)</span><span class="w">                 </span><span class="c1"># Just(7)</span><span class="w">

</span><span class="c1"># With Either</span><span class="w">
</span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="5402327215-13">(</span><span class="n">add</span><span class="p" data-group-id="5402327215-13">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">ap</span><span class="p" data-group-id="5402327215-14">(</span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="5402327215-15">(</span><span class="mi">3</span><span class="p" data-group-id="5402327215-15">)</span><span class="p" data-group-id="5402327215-14">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">ap</span><span class="p" data-group-id="5402327215-16">(</span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="5402327215-17">(</span><span class="mi">4</span><span class="p" data-group-id="5402327215-17">)</span><span class="p" data-group-id="5402327215-16">)</span><span class="w">               </span><span class="c1"># Right(7)</span><span class="w">

</span><span class="c1"># String concatenation</span><span class="w">
</span><span class="n">concat3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="5402327215-18">fn</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k" data-group-id="5402327215-19">fn</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k" data-group-id="5402327215-20">fn</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k" data-group-id="5402327215-20">end</span><span class="w"> </span><span class="k" data-group-id="5402327215-19">end</span><span class="w"> </span><span class="k" data-group-id="5402327215-18">end</span><span class="w">

</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="5402327215-21">(</span><span class="n">concat3</span><span class="p" data-group-id="5402327215-21">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">ap</span><span class="p" data-group-id="5402327215-22">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="5402327215-23">(</span><span class="s">&quot;Hello, &quot;</span><span class="p" data-group-id="5402327215-23">)</span><span class="p" data-group-id="5402327215-22">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">ap</span><span class="p" data-group-id="5402327215-24">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="5402327215-25">(</span><span class="s">&quot;World&quot;</span><span class="p" data-group-id="5402327215-25">)</span><span class="p" data-group-id="5402327215-24">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">ap</span><span class="p" data-group-id="5402327215-26">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="5402327215-27">(</span><span class="s">&quot;!&quot;</span><span class="p" data-group-id="5402327215-27">)</span><span class="p" data-group-id="5402327215-26">)</span><span class="w">               </span><span class="c1"># Just(&quot;Hello, World!&quot;)</span></code></pre><h3 id="flattening-nested-monads" class="section-heading">
  <a href="#flattening-nested-monads" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Flattening Nested Monads</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="c1"># When you have nested monads - use bind to flatten naturally</span><span class="w">
</span><span class="n">nested_maybe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="9146509654-1">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="9146509654-2">(</span><span class="mi">42</span><span class="p" data-group-id="9146509654-2">)</span><span class="p" data-group-id="9146509654-1">)</span><span class="w">
</span><span class="n">flattened</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="9146509654-3">(</span><span class="n">nested_maybe</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="9146509654-4">fn</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="k" data-group-id="9146509654-4">end</span><span class="p" data-group-id="9146509654-3">)</span><span class="w">  </span><span class="c1"># =&gt; Just(42)</span><span class="w">

</span><span class="n">nested_either</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="9146509654-5">(</span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="9146509654-6">(</span><span class="s">&quot;success&quot;</span><span class="p" data-group-id="9146509654-6">)</span><span class="p" data-group-id="9146509654-5">)</span><span class="w">
</span><span class="n">flattened</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="9146509654-7">(</span><span class="n">nested_either</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="9146509654-8">fn</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="k" data-group-id="9146509654-8">end</span><span class="p" data-group-id="9146509654-7">)</span><span class="w">  </span><span class="c1"># =&gt; Right(&quot;success&quot;)</span></code></pre><h2 id="guidelines-for-generic-monad-functions" class="section-heading">
  <a href="#guidelines-for-generic-monad-functions" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Guidelines for Generic Monad Functions</span>
</h2>
<p>When writing functions that work with any monad:</p><ul><li><strong>Use protocol operations only</strong>: <code class="inline">Monad.bind/2</code>, <code class="inline">Monad.map/2</code>, <code class="inline">Monad.ap/2</code></li><li><strong>Avoid specific monad constructors</strong>: Don't use <code class="inline">Maybe.just/1</code> in generic code</li><li><strong>Choose the right operation</strong>: <code class="inline">map</code> for transforming, <code class="inline">bind</code> for chaining, <code class="inline">ap</code> for independent computations</li><li><strong>Test monad laws</strong>: Verify your functions preserve monadic structure  </li><li><strong>Consider performance</strong>: Protocol dispatch has overhead vs direct module calls</li><li><strong>Document type constraints</strong>: Make clear which monads your function supports</li><li><strong>Handle all cases</strong>: Generic code should work correctly with all monadic types</li></ul><h2 id="llm-code-templates" class="section-heading">
  <a href="#llm-code-templates" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">LLM Code Templates</span>
</h2>
<h3 id="basic-monadic-pipeline-template" class="section-heading">
  <a href="#basic-monadic-pipeline-template" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Basic Monadic Pipeline Template</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">build_monadic_pipeline</span><span class="p" data-group-id="4572804643-1">(</span><span class="p" data-group-id="4572804643-1">)</span><span class="w"> </span><span class="k" data-group-id="4572804643-2">do</span><span class="w">
  </span><span class="k" data-group-id="4572804643-3">fn</span><span class="w"> </span><span class="n">initial_value</span><span class="p">,</span><span class="w"> </span><span class="n">monad_type</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="n">initial_value</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">monad_type</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="4572804643-4">(</span><span class="p" data-group-id="4572804643-4">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="4572804643-5">(</span><span class="k" data-group-id="4572804643-6">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> 
      </span><span class="c1"># First transformation (returns monadic value)</span><span class="w">
      </span><span class="n">transformed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transform_step_1</span><span class="p" data-group-id="4572804643-7">(</span><span class="n">x</span><span class="p" data-group-id="4572804643-7">)</span><span class="w">
      </span><span class="n">monad_type</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="4572804643-8">(</span><span class="n">transformed</span><span class="p" data-group-id="4572804643-8">)</span><span class="w">
    </span><span class="k" data-group-id="4572804643-6">end</span><span class="p" data-group-id="4572804643-5">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="4572804643-9">(</span><span class="k" data-group-id="4572804643-10">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="c1"># Second transformation with possible failure</span><span class="w">
      </span><span class="k">case</span><span class="w"> </span><span class="n">validate_step_2</span><span class="p" data-group-id="4572804643-11">(</span><span class="n">x</span><span class="p" data-group-id="4572804643-11">)</span><span class="w"> </span><span class="k" data-group-id="4572804643-12">do</span><span class="w">
        </span><span class="ss">:ok</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">monad_type</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="4572804643-13">(</span><span class="n">x</span><span class="p" data-group-id="4572804643-13">)</span><span class="w">
        </span><span class="p" data-group-id="4572804643-14">{</span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="p" data-group-id="4572804643-14">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">monad_type</span><span class="o">.</span><span class="n">error</span><span class="p" data-group-id="4572804643-15">(</span><span class="n">reason</span><span class="p" data-group-id="4572804643-15">)</span><span class="w">  </span><span class="c1"># Assumes error constructor</span><span class="w">
      </span><span class="k" data-group-id="4572804643-12">end</span><span class="w">
    </span><span class="k" data-group-id="4572804643-10">end</span><span class="p" data-group-id="4572804643-9">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="4572804643-16">(</span><span class="k" data-group-id="4572804643-17">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="c1"># Final transformation</span><span class="w">
      </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finalize_step</span><span class="p" data-group-id="4572804643-18">(</span><span class="n">x</span><span class="p" data-group-id="4572804643-18">)</span><span class="w">
      </span><span class="n">monad_type</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="4572804643-19">(</span><span class="n">result</span><span class="p" data-group-id="4572804643-19">)</span><span class="w">
    </span><span class="k" data-group-id="4572804643-17">end</span><span class="p" data-group-id="4572804643-16">)</span><span class="w">
  </span><span class="k" data-group-id="4572804643-3">end</span><span class="w">
</span><span class="k" data-group-id="4572804643-2">end</span><span class="w">

</span><span class="c1"># Usage with different monads</span><span class="w">
</span><span class="n">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">build_monadic_pipeline</span><span class="p" data-group-id="4572804643-20">(</span><span class="p" data-group-id="4572804643-20">)</span><span class="w">
</span><span class="n">pipeline</span><span class="o">.</span><span class="p" data-group-id="4572804643-21">(</span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="nc">Maybe</span><span class="p" data-group-id="4572804643-21">)</span><span class="w">   </span><span class="c1"># Works with Maybe monad</span><span class="w">
</span><span class="n">pipeline</span><span class="o">.</span><span class="p" data-group-id="4572804643-22">(</span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="nc">Either</span><span class="p" data-group-id="4572804643-22">)</span><span class="w">  </span><span class="c1"># Works with Either monad</span></code></pre><h3 id="monad-law-verification-template" class="section-heading">
  <a href="#monad-law-verification-template" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Monad Law Verification Template</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">verify_monad_laws</span><span class="p" data-group-id="9782449711-1">(</span><span class="n">monad_module</span><span class="p">,</span><span class="w"> </span><span class="n">test_value</span><span class="p">,</span><span class="w"> </span><span class="n">test_function</span><span class="p" data-group-id="9782449711-1">)</span><span class="w"> </span><span class="k" data-group-id="9782449711-2">do</span><span class="w">
  </span><span class="c1"># Left Identity Law: return(a) &gt;&gt;= f === f(a)</span><span class="w">
  </span><span class="n">left_identity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="9782449711-3">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="9782449711-4">(</span><span class="n">test_value</span><span class="p" data-group-id="9782449711-4">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="9782449711-5">(</span><span class="n">test_function</span><span class="p" data-group-id="9782449711-5">)</span><span class="w">
    </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_function</span><span class="o">.</span><span class="p" data-group-id="9782449711-6">(</span><span class="n">test_value</span><span class="p" data-group-id="9782449711-6">)</span><span class="w">
    </span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">right</span><span class="w">
  </span><span class="k" data-group-id="9782449711-3">end</span><span class="w">
  
  </span><span class="c1"># Right Identity Law: m &gt;&gt;= return === m  </span><span class="w">
  </span><span class="n">right_identity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="9782449711-7">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="n">test_monad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="9782449711-8">(</span><span class="n">test_value</span><span class="p" data-group-id="9782449711-8">)</span><span class="w">
    </span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_monad</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="9782449711-9">(</span><span class="o">&amp;</span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="9782449711-9">)</span><span class="w">
    </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_monad</span><span class="w">
    </span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">right</span><span class="w">
  </span><span class="k" data-group-id="9782449711-7">end</span><span class="w">
  
  </span><span class="c1"># Associativity Law: (m &gt;&gt;= f) &gt;&gt;= g === m &gt;&gt;= (\x -&gt; f(x) &gt;&gt;= g)</span><span class="w">
  </span><span class="n">associativity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="9782449711-10">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="n">test_monad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="9782449711-11">(</span><span class="n">test_value</span><span class="p" data-group-id="9782449711-11">)</span><span class="w">
    </span><span class="n">second_function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="9782449711-12">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="9782449711-13">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p" data-group-id="9782449711-13">)</span><span class="w"> </span><span class="k" data-group-id="9782449711-12">end</span><span class="w">
    
    </span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_monad</span><span class="w">
           </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="9782449711-14">(</span><span class="n">test_function</span><span class="p" data-group-id="9782449711-14">)</span><span class="w"> 
           </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="9782449711-15">(</span><span class="n">second_function</span><span class="p" data-group-id="9782449711-15">)</span><span class="w">
    
    </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_monad</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="9782449711-16">(</span><span class="k" data-group-id="9782449711-17">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="n">test_function</span><span class="o">.</span><span class="p" data-group-id="9782449711-18">(</span><span class="n">x</span><span class="p" data-group-id="9782449711-18">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="9782449711-19">(</span><span class="n">second_function</span><span class="p" data-group-id="9782449711-19">)</span><span class="w">
    </span><span class="k" data-group-id="9782449711-17">end</span><span class="p" data-group-id="9782449711-16">)</span><span class="w">
    
    </span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">right</span><span class="w">
  </span><span class="k" data-group-id="9782449711-10">end</span><span class="w">
  
  </span><span class="p" data-group-id="9782449711-20">%{</span><span class="w">
    </span><span class="ss">left_identity</span><span class="p">:</span><span class="w"> </span><span class="n">left_identity</span><span class="o">.</span><span class="p" data-group-id="9782449711-21">(</span><span class="p" data-group-id="9782449711-21">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">right_identity</span><span class="p">:</span><span class="w"> </span><span class="n">right_identity</span><span class="o">.</span><span class="p" data-group-id="9782449711-22">(</span><span class="p" data-group-id="9782449711-22">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">associativity</span><span class="p">:</span><span class="w"> </span><span class="n">associativity</span><span class="o">.</span><span class="p" data-group-id="9782449711-23">(</span><span class="p" data-group-id="9782449711-23">)</span><span class="w">
  </span><span class="p" data-group-id="9782449711-20">}</span><span class="w">
</span><span class="k" data-group-id="9782449711-2">end</span><span class="w">

</span><span class="c1"># Test all laws for a monad</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">test_monad_implementation</span><span class="p" data-group-id="9782449711-24">(</span><span class="n">monad_module</span><span class="p" data-group-id="9782449711-24">)</span><span class="w"> </span><span class="k" data-group-id="9782449711-25">do</span><span class="w">
  </span><span class="n">test_fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="9782449711-26">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="9782449711-27">(</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="9782449711-27">)</span><span class="w"> </span><span class="k" data-group-id="9782449711-26">end</span><span class="w">
  </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">verify_monad_laws</span><span class="p" data-group-id="9782449711-28">(</span><span class="n">monad_module</span><span class="p">,</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="n">test_fn</span><span class="p" data-group-id="9782449711-28">)</span><span class="w">
  
  </span><span class="n">all_passed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">all?</span><span class="p" data-group-id="9782449711-29">(</span><span class="nc">Map</span><span class="o">.</span><span class="n">values</span><span class="p" data-group-id="9782449711-30">(</span><span class="n">results</span><span class="p" data-group-id="9782449711-30">)</span><span class="p" data-group-id="9782449711-29">)</span><span class="w">
  </span><span class="p" data-group-id="9782449711-31">{</span><span class="n">all_passed</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p" data-group-id="9782449711-31">}</span><span class="w">
</span><span class="k" data-group-id="9782449711-25">end</span></code></pre><h3 id="kleisli-function-factory-template" class="section-heading">
  <a href="#kleisli-function-factory-template" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Kleisli Function Factory Template</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">build_kleisli_factory</span><span class="p" data-group-id="5155692575-1">(</span><span class="n">monad_module</span><span class="p" data-group-id="5155692575-1">)</span><span class="w"> </span><span class="k" data-group-id="5155692575-2">do</span><span class="w">
  </span><span class="p" data-group-id="5155692575-3">%{</span><span class="w">
    </span><span class="c1"># Safe mathematical operations</span><span class="w">
    </span><span class="ss">safe_divide</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="5155692575-4">fn</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="5155692575-5">do</span><span class="w">
        </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="5155692575-6">(</span><span class="n">a</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">b</span><span class="p" data-group-id="5155692575-6">)</span><span class="w">
      </span><span class="k" data-group-id="5155692575-5">else</span><span class="w">
        </span><span class="n">monad_module</span><span class="o">.</span><span class="n">error</span><span class="p" data-group-id="5155692575-7">(</span><span class="s">&quot;division by zero&quot;</span><span class="p" data-group-id="5155692575-7">)</span><span class="w">
      </span><span class="k" data-group-id="5155692575-5">end</span><span class="w">
    </span><span class="k" data-group-id="5155692575-4">end</span><span class="p">,</span><span class="w">
    
    </span><span class="ss">safe_sqrt</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="5155692575-8">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="5155692575-9">do</span><span class="w">
        </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="5155692575-10">(</span><span class="nc">:math</span><span class="o">.</span><span class="n">sqrt</span><span class="p" data-group-id="5155692575-11">(</span><span class="n">x</span><span class="p" data-group-id="5155692575-11">)</span><span class="p" data-group-id="5155692575-10">)</span><span class="w">
      </span><span class="k" data-group-id="5155692575-9">else</span><span class="w">
        </span><span class="n">monad_module</span><span class="o">.</span><span class="n">error</span><span class="p" data-group-id="5155692575-12">(</span><span class="s">&quot;negative square root&quot;</span><span class="p" data-group-id="5155692575-12">)</span><span class="w">
      </span><span class="k" data-group-id="5155692575-9">end</span><span class="w">
    </span><span class="k" data-group-id="5155692575-8">end</span><span class="p">,</span><span class="w">
    
    </span><span class="c1"># Validation operations</span><span class="w">
    </span><span class="ss">validate_range</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="5155692575-13">fn</span><span class="w"> </span><span class="n">min</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="k" data-group-id="5155692575-14">fn</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="k" data-group-id="5155692575-15">do</span><span class="w">
          </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="5155692575-16">(</span><span class="n">value</span><span class="p" data-group-id="5155692575-16">)</span><span class="w">
        </span><span class="k" data-group-id="5155692575-15">else</span><span class="w">
          </span><span class="n">monad_module</span><span class="o">.</span><span class="n">error</span><span class="p" data-group-id="5155692575-17">(</span><span class="s">&quot;value </span><span class="si" data-group-id="5155692575-18">#{</span><span class="n">value</span><span class="si" data-group-id="5155692575-18">}</span><span class="s"> not in range </span><span class="si" data-group-id="5155692575-19">#{</span><span class="n">min</span><span class="si" data-group-id="5155692575-19">}</span><span class="s">-</span><span class="si" data-group-id="5155692575-20">#{</span><span class="n">max</span><span class="si" data-group-id="5155692575-20">}</span><span class="s">&quot;</span><span class="p" data-group-id="5155692575-17">)</span><span class="w">
        </span><span class="k" data-group-id="5155692575-15">end</span><span class="w">
      </span><span class="k" data-group-id="5155692575-14">end</span><span class="w">
    </span><span class="k" data-group-id="5155692575-13">end</span><span class="p">,</span><span class="w">
    
    </span><span class="c1"># Transformation operations</span><span class="w">
    </span><span class="ss">transform_with</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="5155692575-21">fn</span><span class="w"> </span><span class="n">transformer</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="k" data-group-id="5155692575-22">fn</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="k">try</span><span class="w"> </span><span class="k" data-group-id="5155692575-23">do</span><span class="w">
          </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformer</span><span class="o">.</span><span class="p" data-group-id="5155692575-24">(</span><span class="n">value</span><span class="p" data-group-id="5155692575-24">)</span><span class="w">
          </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="5155692575-25">(</span><span class="n">result</span><span class="p" data-group-id="5155692575-25">)</span><span class="w">
        </span><span class="k" data-group-id="5155692575-23">rescue</span><span class="w">
          </span><span class="n">error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">monad_module</span><span class="o">.</span><span class="n">error</span><span class="p" data-group-id="5155692575-26">(</span><span class="s">&quot;transformation failed: </span><span class="si" data-group-id="5155692575-27">#{</span><span class="n">inspect</span><span class="p" data-group-id="5155692575-28">(</span><span class="n">error</span><span class="p" data-group-id="5155692575-28">)</span><span class="si" data-group-id="5155692575-27">}</span><span class="s">&quot;</span><span class="p" data-group-id="5155692575-26">)</span><span class="w">
        </span><span class="k" data-group-id="5155692575-23">end</span><span class="w">
      </span><span class="k" data-group-id="5155692575-22">end</span><span class="w">
    </span><span class="k" data-group-id="5155692575-21">end</span><span class="p">,</span><span class="w">
    
    </span><span class="c1"># Conditional operations</span><span class="w">
    </span><span class="ss">when_condition</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="5155692575-29">fn</span><span class="w"> </span><span class="n">predicate</span><span class="p">,</span><span class="w"> </span><span class="n">then_fn</span><span class="p">,</span><span class="w"> </span><span class="n">else_fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="k" data-group-id="5155692575-30">fn</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="n">predicate</span><span class="o">.</span><span class="p" data-group-id="5155692575-31">(</span><span class="n">value</span><span class="p" data-group-id="5155692575-31">)</span><span class="w"> </span><span class="k" data-group-id="5155692575-32">do</span><span class="w">
          </span><span class="n">then_fn</span><span class="o">.</span><span class="p" data-group-id="5155692575-33">(</span><span class="n">value</span><span class="p" data-group-id="5155692575-33">)</span><span class="w">
        </span><span class="k" data-group-id="5155692575-32">else</span><span class="w">
          </span><span class="n">else_fn</span><span class="o">.</span><span class="p" data-group-id="5155692575-34">(</span><span class="n">value</span><span class="p" data-group-id="5155692575-34">)</span><span class="w">
        </span><span class="k" data-group-id="5155692575-32">end</span><span class="w">
      </span><span class="k" data-group-id="5155692575-30">end</span><span class="w">
    </span><span class="k" data-group-id="5155692575-29">end</span><span class="w">
  </span><span class="p" data-group-id="5155692575-3">}</span><span class="w">
</span><span class="k" data-group-id="5155692575-2">end</span><span class="w">

</span><span class="c1"># Usage with different monads</span><span class="w">
</span><span class="n">maybe_ops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">build_kleisli_factory</span><span class="p" data-group-id="5155692575-35">(</span><span class="nc">Maybe</span><span class="p" data-group-id="5155692575-35">)</span><span class="w">
</span><span class="n">either_ops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">build_kleisli_factory</span><span class="p" data-group-id="5155692575-36">(</span><span class="nc">Either</span><span class="p" data-group-id="5155692575-36">)</span><span class="w">

</span><span class="c1"># Chain operations</span><span class="w">
</span><span class="mi">42</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">maybe_ops</span><span class="o">.</span><span class="n">safe_divide</span><span class="o">.</span><span class="p" data-group-id="5155692575-37">(</span><span class="mi">6</span><span class="p" data-group-id="5155692575-37">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="5155692575-38">(</span><span class="n">maybe_ops</span><span class="o">.</span><span class="n">safe_sqrt</span><span class="p" data-group-id="5155692575-38">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="5155692575-39">(</span><span class="n">maybe_ops</span><span class="o">.</span><span class="n">validate_range</span><span class="o">.</span><span class="p" data-group-id="5155692575-40">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="5155692575-40">)</span><span class="p" data-group-id="5155692575-39">)</span></code></pre><h3 id="applicative-vs-monadic-style-template" class="section-heading">
  <a href="#applicative-vs-monadic-style-template" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Applicative vs. Monadic Style Template</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">comparison_template</span><span class="p" data-group-id="7791936643-1">(</span><span class="p" data-group-id="7791936643-1">)</span><span class="w"> </span><span class="k" data-group-id="7791936643-2">do</span><span class="w">
  </span><span class="kn">import</span><span class="w"> </span><span class="nc">Funx.Monad</span><span class="w">
  
  </span><span class="c1"># Sample data</span><span class="w">
  </span><span class="n">maybe_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="7791936643-3">(</span><span class="mi">5</span><span class="p" data-group-id="7791936643-3">)</span><span class="w">
  </span><span class="n">maybe_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="7791936643-4">(</span><span class="mi">10</span><span class="p" data-group-id="7791936643-4">)</span><span class="w">
  </span><span class="n">maybe_c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="7791936643-5">(</span><span class="mi">2</span><span class="p" data-group-id="7791936643-5">)</span><span class="w">
  
  </span><span class="c1"># Applicative style - all computations are independent</span><span class="w">
  </span><span class="n">add3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="7791936643-6">fn</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k" data-group-id="7791936643-7">fn</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k" data-group-id="7791936643-8">fn</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k" data-group-id="7791936643-8">end</span><span class="w"> </span><span class="k" data-group-id="7791936643-7">end</span><span class="w"> </span><span class="k" data-group-id="7791936643-6">end</span><span class="w">
  </span><span class="n">applicative_result</span><span class="w"> </span><span class="o">=</span><span class="w"> 
    </span><span class="n">return</span><span class="p" data-group-id="7791936643-9">(</span><span class="n">add3</span><span class="p" data-group-id="7791936643-9">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">ap</span><span class="p" data-group-id="7791936643-10">(</span><span class="n">maybe_a</span><span class="p" data-group-id="7791936643-10">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">ap</span><span class="p" data-group-id="7791936643-11">(</span><span class="n">maybe_b</span><span class="p" data-group-id="7791936643-11">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">ap</span><span class="p" data-group-id="7791936643-12">(</span><span class="n">maybe_c</span><span class="p" data-group-id="7791936643-12">)</span><span class="w">  </span><span class="c1"># Just(17)</span><span class="w">
  
  </span><span class="c1"># Monadic style - later computations depend on earlier ones</span><span class="w">
  </span><span class="n">monadic_result</span><span class="w"> </span><span class="o">=</span><span class="w"> 
    </span><span class="n">maybe_a</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">bind</span><span class="p" data-group-id="7791936643-13">(</span><span class="k" data-group-id="7791936643-14">fn</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="n">maybe_b</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">bind</span><span class="p" data-group-id="7791936643-15">(</span><span class="k" data-group-id="7791936643-16">fn</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="c1"># This computation depends on both a and b</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k" data-group-id="7791936643-17">do</span><span class="w">
          </span><span class="n">maybe_c</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">bind</span><span class="p" data-group-id="7791936643-18">(</span><span class="k" data-group-id="7791936643-19">fn</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
            </span><span class="n">return</span><span class="p" data-group-id="7791936643-20">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">100</span><span class="p" data-group-id="7791936643-20">)</span><span class="w">  </span><span class="c1"># Bonus for large values</span><span class="w">
          </span><span class="k" data-group-id="7791936643-19">end</span><span class="p" data-group-id="7791936643-18">)</span><span class="w">
        </span><span class="k" data-group-id="7791936643-17">else</span><span class="w">
          </span><span class="n">maybe_c</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">bind</span><span class="p" data-group-id="7791936643-21">(</span><span class="k" data-group-id="7791936643-22">fn</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
            </span><span class="n">return</span><span class="p" data-group-id="7791936643-23">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="p" data-group-id="7791936643-23">)</span><span class="w">
          </span><span class="k" data-group-id="7791936643-22">end</span><span class="p" data-group-id="7791936643-21">)</span><span class="w">
        </span><span class="k" data-group-id="7791936643-17">end</span><span class="w">
      </span><span class="k" data-group-id="7791936643-16">end</span><span class="p" data-group-id="7791936643-15">)</span><span class="w">
    </span><span class="k" data-group-id="7791936643-14">end</span><span class="p" data-group-id="7791936643-13">)</span><span class="w">
  
  </span><span class="c1"># When to use each:</span><span class="w">
  </span><span class="c1"># - Applicative: When operations are independent (use ap)</span><span class="w">
  </span><span class="c1"># - Monadic: When later operations depend on earlier results (use bind)</span><span class="w">
  
  </span><span class="p" data-group-id="7791936643-24">%{</span><span class="w">
    </span><span class="ss">applicative</span><span class="p">:</span><span class="w"> </span><span class="n">applicative_result</span><span class="p">,</span><span class="w">  </span><span class="c1"># Just(17)</span><span class="w">
    </span><span class="ss">monadic</span><span class="p">:</span><span class="w"> </span><span class="n">monadic_result</span><span class="w">          </span><span class="c1"># Just(117) - includes bonus</span><span class="w">
  </span><span class="p" data-group-id="7791936643-24">}</span><span class="w">
</span><span class="k" data-group-id="7791936643-2">end</span></code></pre><h3 id="monad-transformer-pattern-template" class="section-heading">
  <a href="#monad-transformer-pattern-template" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Monad Transformer Pattern Template</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">build_transformer_stack</span><span class="p" data-group-id="0392047404-1">(</span><span class="p" data-group-id="0392047404-1">)</span><span class="w"> </span><span class="k" data-group-id="0392047404-2">do</span><span class="w">
  </span><span class="c1"># Example: Maybe + IO monad transformer</span><span class="w">
  </span><span class="c1"># MaybeT IO a = IO (Maybe a)</span><span class="w">
  
  </span><span class="c1"># Basic operations for the transformer</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">lift_io</span><span class="p" data-group-id="0392047404-3">(</span><span class="n">io_action</span><span class="p" data-group-id="0392047404-3">)</span><span class="w"> </span><span class="k" data-group-id="0392047404-4">do</span><span class="w">
    </span><span class="k" data-group-id="0392047404-5">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> 
      </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_action</span><span class="o">.</span><span class="p" data-group-id="0392047404-6">(</span><span class="p" data-group-id="0392047404-6">)</span><span class="w">
      </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="0392047404-7">(</span><span class="n">result</span><span class="p" data-group-id="0392047404-7">)</span><span class="w">
    </span><span class="k" data-group-id="0392047404-5">end</span><span class="w">
  </span><span class="k" data-group-id="0392047404-4">end</span><span class="w">
  
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">lift_maybe</span><span class="p" data-group-id="0392047404-8">(</span><span class="n">maybe_value</span><span class="p" data-group-id="0392047404-8">)</span><span class="w"> </span><span class="k" data-group-id="0392047404-9">do</span><span class="w">
    </span><span class="k" data-group-id="0392047404-10">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">maybe_value</span><span class="w"> </span><span class="k" data-group-id="0392047404-10">end</span><span class="w">
  </span><span class="k" data-group-id="0392047404-9">end</span><span class="w">
  
  </span><span class="c1"># Bind for the transformer stack</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">bind_transformer</span><span class="p" data-group-id="0392047404-11">(</span><span class="n">transformer_action</span><span class="p">,</span><span class="w"> </span><span class="n">kleisli_fn</span><span class="p" data-group-id="0392047404-11">)</span><span class="w"> </span><span class="k" data-group-id="0392047404-12">do</span><span class="w">
    </span><span class="k" data-group-id="0392047404-13">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="k">case</span><span class="w"> </span><span class="n">transformer_action</span><span class="o">.</span><span class="p" data-group-id="0392047404-14">(</span><span class="p" data-group-id="0392047404-14">)</span><span class="w"> </span><span class="k" data-group-id="0392047404-15">do</span><span class="w">
        </span><span class="nc">Maybe.Nothing</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="0392047404-16">(</span><span class="p" data-group-id="0392047404-16">)</span><span class="w">
        </span><span class="nc">Maybe.Just</span><span class="p" data-group-id="0392047404-17">(</span><span class="n">value</span><span class="p" data-group-id="0392047404-17">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
          </span><span class="n">next_action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kleisli_fn</span><span class="o">.</span><span class="p" data-group-id="0392047404-18">(</span><span class="n">value</span><span class="p" data-group-id="0392047404-18">)</span><span class="w">
          </span><span class="n">next_action</span><span class="o">.</span><span class="p" data-group-id="0392047404-19">(</span><span class="p" data-group-id="0392047404-19">)</span><span class="w">
      </span><span class="k" data-group-id="0392047404-15">end</span><span class="w">
    </span><span class="k" data-group-id="0392047404-13">end</span><span class="w">
  </span><span class="k" data-group-id="0392047404-12">end</span><span class="w">
  
  </span><span class="c1"># Example usage</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">fetch_and_process_user</span><span class="p" data-group-id="0392047404-20">(</span><span class="n">user_id</span><span class="p" data-group-id="0392047404-20">)</span><span class="w"> </span><span class="k" data-group-id="0392047404-21">do</span><span class="w">
    </span><span class="c1"># This would be a complex operation involving both IO and Maybe</span><span class="w">
    </span><span class="n">lift_io</span><span class="p" data-group-id="0392047404-22">(</span><span class="k" data-group-id="0392047404-23">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">fetch_user_from_db</span><span class="p" data-group-id="0392047404-24">(</span><span class="n">user_id</span><span class="p" data-group-id="0392047404-24">)</span><span class="w"> </span><span class="k" data-group-id="0392047404-23">end</span><span class="p" data-group-id="0392047404-22">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">bind_transformer</span><span class="p" data-group-id="0392047404-25">(</span><span class="k" data-group-id="0392047404-26">fn</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="n">active</span><span class="w"> </span><span class="k" data-group-id="0392047404-27">do</span><span class="w">
        </span><span class="n">lift_maybe</span><span class="p" data-group-id="0392047404-28">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="0392047404-29">(</span><span class="n">user</span><span class="p" data-group-id="0392047404-29">)</span><span class="p" data-group-id="0392047404-28">)</span><span class="w">
      </span><span class="k" data-group-id="0392047404-27">else</span><span class="w">
        </span><span class="n">lift_maybe</span><span class="p" data-group-id="0392047404-30">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="0392047404-31">(</span><span class="p" data-group-id="0392047404-31">)</span><span class="p" data-group-id="0392047404-30">)</span><span class="w">
      </span><span class="k" data-group-id="0392047404-27">end</span><span class="w">
    </span><span class="k" data-group-id="0392047404-26">end</span><span class="p" data-group-id="0392047404-25">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">bind_transformer</span><span class="p" data-group-id="0392047404-32">(</span><span class="k" data-group-id="0392047404-33">fn</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="n">lift_io</span><span class="p" data-group-id="0392047404-34">(</span><span class="k" data-group-id="0392047404-35">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> 
        </span><span class="n">processed_user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">process_user_data</span><span class="p" data-group-id="0392047404-36">(</span><span class="n">user</span><span class="p" data-group-id="0392047404-36">)</span><span class="w">
        </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="0392047404-37">(</span><span class="n">processed_user</span><span class="p" data-group-id="0392047404-37">)</span><span class="w">
      </span><span class="k" data-group-id="0392047404-35">end</span><span class="p" data-group-id="0392047404-34">)</span><span class="w">
    </span><span class="k" data-group-id="0392047404-33">end</span><span class="p" data-group-id="0392047404-32">)</span><span class="w">
  </span><span class="k" data-group-id="0392047404-21">end</span><span class="w">
  
  </span><span class="c1"># Run the transformer stack</span><span class="w">
  </span><span class="n">user_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fetch_and_process_user</span><span class="p" data-group-id="0392047404-38">(</span><span class="mi">123</span><span class="p" data-group-id="0392047404-38">)</span><span class="w">
  </span><span class="n">final_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_result</span><span class="o">.</span><span class="p" data-group-id="0392047404-39">(</span><span class="p" data-group-id="0392047404-39">)</span><span class="w">  </span><span class="c1"># IO (Maybe User)</span><span class="w">
</span><span class="k" data-group-id="0392047404-2">end</span></code></pre><h3 id="utils-integration-template" class="section-heading">
  <a href="#utils-integration-template" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Utils Integration Template</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">build_utils_integration</span><span class="p" data-group-id="6640614086-1">(</span><span class="p" data-group-id="6640614086-1">)</span><span class="w"> </span><span class="k" data-group-id="6640614086-2">do</span><span class="w">
  </span><span class="c1"># Combine Monad protocol with Utils currying</span><span class="w">
  
  </span><span class="c1"># Curry monadic operations for pipeline use</span><span class="w">
  </span><span class="n">bind_with</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Funx.Utils</span><span class="o">.</span><span class="n">curry_r</span><span class="p" data-group-id="6640614086-3">(</span><span class="o">&amp;</span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="o">/</span><span class="mi">2</span><span class="p" data-group-id="6640614086-3">)</span><span class="w">
  
  </span><span class="c1"># Create reusable monadic operations</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">create_monadic_validators</span><span class="p" data-group-id="6640614086-4">(</span><span class="p" data-group-id="6640614086-4">)</span><span class="w"> </span><span class="k" data-group-id="6640614086-5">do</span><span class="w">
    </span><span class="p" data-group-id="6640614086-6">%{</span><span class="w">
      </span><span class="ss">positive</span><span class="p">:</span><span class="w"> </span><span class="n">bind_with</span><span class="o">.</span><span class="p" data-group-id="6640614086-7">(</span><span class="k" data-group-id="6640614086-8">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="6640614086-9">do</span><span class="w">
          </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="6640614086-10">(</span><span class="n">x</span><span class="p" data-group-id="6640614086-10">)</span><span class="w">
        </span><span class="k" data-group-id="6640614086-9">else</span><span class="w">
          </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="6640614086-11">(</span><span class="p" data-group-id="6640614086-11">)</span><span class="w">
        </span><span class="k" data-group-id="6640614086-9">end</span><span class="w">
      </span><span class="k" data-group-id="6640614086-8">end</span><span class="p" data-group-id="6640614086-7">)</span><span class="p">,</span><span class="w">
      
      </span><span class="ss">even</span><span class="p">:</span><span class="w"> </span><span class="n">bind_with</span><span class="o">.</span><span class="p" data-group-id="6640614086-12">(</span><span class="k" data-group-id="6640614086-13">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="n">rem</span><span class="p" data-group-id="6640614086-14">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="6640614086-14">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="6640614086-15">do</span><span class="w">
          </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="6640614086-16">(</span><span class="n">x</span><span class="p" data-group-id="6640614086-16">)</span><span class="w">
        </span><span class="k" data-group-id="6640614086-15">else</span><span class="w">
          </span><span class="nc">Either</span><span class="o">.</span><span class="n">left</span><span class="p" data-group-id="6640614086-17">(</span><span class="s">&quot;must be even&quot;</span><span class="p" data-group-id="6640614086-17">)</span><span class="w">
        </span><span class="k" data-group-id="6640614086-15">end</span><span class="w">
      </span><span class="k" data-group-id="6640614086-13">end</span><span class="p" data-group-id="6640614086-12">)</span><span class="p">,</span><span class="w">
      
      </span><span class="ss">in_range</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="6640614086-18">fn</span><span class="w"> </span><span class="n">min</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="n">bind_with</span><span class="o">.</span><span class="p" data-group-id="6640614086-19">(</span><span class="k" data-group-id="6640614086-20">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
          </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="k" data-group-id="6640614086-21">do</span><span class="w">
            </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="6640614086-22">(</span><span class="n">x</span><span class="p" data-group-id="6640614086-22">)</span><span class="w">
          </span><span class="k" data-group-id="6640614086-21">else</span><span class="w">
            </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="6640614086-23">(</span><span class="p" data-group-id="6640614086-23">)</span><span class="w">
          </span><span class="k" data-group-id="6640614086-21">end</span><span class="w">
        </span><span class="k" data-group-id="6640614086-20">end</span><span class="p" data-group-id="6640614086-19">)</span><span class="w">
      </span><span class="k" data-group-id="6640614086-18">end</span><span class="w">
    </span><span class="p" data-group-id="6640614086-6">}</span><span class="w">
  </span><span class="k" data-group-id="6640614086-5">end</span><span class="w">
  
  </span><span class="c1"># Use in pipelines</span><span class="w">
  </span><span class="n">validators</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_monadic_validators</span><span class="p" data-group-id="6640614086-24">(</span><span class="p" data-group-id="6640614086-24">)</span><span class="w">
  
  </span><span class="c1"># Pipeline with curried monadic operations</span><span class="w">
  </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="6640614086-25">(</span><span class="mi">42</span><span class="p" data-group-id="6640614086-25">)</span><span class="w">
           </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">validators</span><span class="o">.</span><span class="n">positive</span><span class="o">.</span><span class="p" data-group-id="6640614086-26">(</span><span class="p" data-group-id="6640614086-26">)</span><span class="w">
           </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">bind_with</span><span class="o">.</span><span class="p" data-group-id="6640614086-27">(</span><span class="k" data-group-id="6640614086-28">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="6640614086-29">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="6640614086-29">)</span><span class="w"> </span><span class="k" data-group-id="6640614086-28">end</span><span class="p" data-group-id="6640614086-27">)</span><span class="o">.</span><span class="p" data-group-id="6640614086-30">(</span><span class="p" data-group-id="6640614086-30">)</span><span class="w">
           </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">validators</span><span class="o">.</span><span class="n">in_range</span><span class="o">.</span><span class="p" data-group-id="6640614086-31">(</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p" data-group-id="6640614086-31">)</span><span class="o">.</span><span class="p" data-group-id="6640614086-32">(</span><span class="p" data-group-id="6640614086-32">)</span><span class="w">
  
  </span><span class="c1"># Compose multiple validators</span><span class="w">
  </span><span class="n">validate_positive_even</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="6640614086-33">fn</span><span class="w"> </span><span class="n">monad_value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="n">monad_value</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">validators</span><span class="o">.</span><span class="n">positive</span><span class="o">.</span><span class="p" data-group-id="6640614086-34">(</span><span class="p" data-group-id="6640614086-34">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">validators</span><span class="o">.</span><span class="n">even</span><span class="o">.</span><span class="p" data-group-id="6640614086-35">(</span><span class="p" data-group-id="6640614086-35">)</span><span class="w">
  </span><span class="k" data-group-id="6640614086-33">end</span><span class="w">
  
  </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="6640614086-36">(</span><span class="mi">20</span><span class="p" data-group-id="6640614086-36">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">validate_positive_even</span><span class="o">.</span><span class="p" data-group-id="6640614086-37">(</span><span class="p" data-group-id="6640614086-37">)</span><span class="w">
</span><span class="k" data-group-id="6640614086-2">end</span></code></pre><h2 id="llm-testing-guidance" class="section-heading">
  <a href="#llm-testing-guidance" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">LLM Testing Guidance</span>
</h2>
<h3 id="test-protocol-implementation" class="section-heading">
  <a href="#test-protocol-implementation" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Test Protocol Implementation</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MonadLawTest</span><span class="w"> </span><span class="k" data-group-id="1491201538-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">ExUnit.Case</span><span class="w">
  
  </span><span class="c1"># Test that a monad implementation satisfies the laws</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">test_monad_laws</span><span class="p" data-group-id="1491201538-2">(</span><span class="n">monad_module</span><span class="p">,</span><span class="w"> </span><span class="n">sample_values</span><span class="p">,</span><span class="w"> </span><span class="n">sample_functions</span><span class="p" data-group-id="1491201538-2">)</span><span class="w"> </span><span class="k" data-group-id="1491201538-3">do</span><span class="w">
    </span><span class="nc">Enum</span><span class="o">.</span><span class="n">each</span><span class="p" data-group-id="1491201538-4">(</span><span class="n">sample_values</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="1491201538-5">fn</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="nc">Enum</span><span class="o">.</span><span class="n">each</span><span class="p" data-group-id="1491201538-6">(</span><span class="n">sample_functions</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="1491201538-7">fn</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="n">test_left_identity</span><span class="p" data-group-id="1491201538-8">(</span><span class="n">monad_module</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p" data-group-id="1491201538-8">)</span><span class="w">
        </span><span class="n">test_right_identity</span><span class="p" data-group-id="1491201538-9">(</span><span class="n">monad_module</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p" data-group-id="1491201538-9">)</span><span class="w">
        </span><span class="n">test_associativity</span><span class="p" data-group-id="1491201538-10">(</span><span class="n">monad_module</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p" data-group-id="1491201538-10">)</span><span class="w">
      </span><span class="k" data-group-id="1491201538-7">end</span><span class="p" data-group-id="1491201538-6">)</span><span class="w">
    </span><span class="k" data-group-id="1491201538-5">end</span><span class="p" data-group-id="1491201538-4">)</span><span class="w">
  </span><span class="k" data-group-id="1491201538-3">end</span><span class="w">
  
  </span><span class="kd">defp</span><span class="w"> </span><span class="nf">test_left_identity</span><span class="p" data-group-id="1491201538-11">(</span><span class="n">monad_module</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">kleisli_fn</span><span class="p" data-group-id="1491201538-11">)</span><span class="w"> </span><span class="k" data-group-id="1491201538-12">do</span><span class="w">
    </span><span class="c1"># return(a) &gt;&gt;= f === f(a)</span><span class="w">
    </span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="1491201538-13">(</span><span class="n">value</span><span class="p" data-group-id="1491201538-13">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1491201538-14">(</span><span class="n">kleisli_fn</span><span class="p" data-group-id="1491201538-14">)</span><span class="w">
    </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kleisli_fn</span><span class="o">.</span><span class="p" data-group-id="1491201538-15">(</span><span class="n">value</span><span class="p" data-group-id="1491201538-15">)</span><span class="w">
    
    </span><span class="n">assert</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;&quot;
    Left identity law failed for </span><span class="si" data-group-id="1491201538-16">#{</span><span class="n">inspect</span><span class="p" data-group-id="1491201538-17">(</span><span class="n">monad_module</span><span class="p" data-group-id="1491201538-17">)</span><span class="si" data-group-id="1491201538-16">}</span><span class="s">
    Value: </span><span class="si" data-group-id="1491201538-18">#{</span><span class="n">inspect</span><span class="p" data-group-id="1491201538-19">(</span><span class="n">value</span><span class="p" data-group-id="1491201538-19">)</span><span class="si" data-group-id="1491201538-18">}</span><span class="s">
    Function: </span><span class="si" data-group-id="1491201538-20">#{</span><span class="n">inspect</span><span class="p" data-group-id="1491201538-21">(</span><span class="n">kleisli_fn</span><span class="p" data-group-id="1491201538-21">)</span><span class="si" data-group-id="1491201538-20">}</span><span class="s">
    &quot;&quot;&quot;</span><span class="w">
  </span><span class="k" data-group-id="1491201538-12">end</span><span class="w">
  
  </span><span class="kd">defp</span><span class="w"> </span><span class="nf">test_right_identity</span><span class="p" data-group-id="1491201538-22">(</span><span class="n">monad_module</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p" data-group-id="1491201538-22">)</span><span class="w"> </span><span class="k" data-group-id="1491201538-23">do</span><span class="w">
    </span><span class="c1"># m &gt;&gt;= return === m</span><span class="w">
    </span><span class="n">monad_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="1491201538-24">(</span><span class="n">value</span><span class="p" data-group-id="1491201538-24">)</span><span class="w">
    </span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monad_value</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1491201538-25">(</span><span class="o">&amp;</span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="1491201538-25">)</span><span class="w">
    </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monad_value</span><span class="w">
    
    </span><span class="n">assert</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;&quot;
    Right identity law failed for </span><span class="si" data-group-id="1491201538-26">#{</span><span class="n">inspect</span><span class="p" data-group-id="1491201538-27">(</span><span class="n">monad_module</span><span class="p" data-group-id="1491201538-27">)</span><span class="si" data-group-id="1491201538-26">}</span><span class="s">
    Value: </span><span class="si" data-group-id="1491201538-28">#{</span><span class="n">inspect</span><span class="p" data-group-id="1491201538-29">(</span><span class="n">value</span><span class="p" data-group-id="1491201538-29">)</span><span class="si" data-group-id="1491201538-28">}</span><span class="s">
    &quot;&quot;&quot;</span><span class="w">
  </span><span class="k" data-group-id="1491201538-23">end</span><span class="w">
  
  </span><span class="kd">defp</span><span class="w"> </span><span class="nf">test_associativity</span><span class="p" data-group-id="1491201538-30">(</span><span class="n">monad_module</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p" data-group-id="1491201538-30">)</span><span class="w"> </span><span class="k" data-group-id="1491201538-31">do</span><span class="w">
    </span><span class="c1"># (m &gt;&gt;= f) &gt;&gt;= g === m &gt;&gt;= (\x -&gt; f(x) &gt;&gt;= g)</span><span class="w">
    </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="1491201538-32">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="1491201538-33">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p" data-group-id="1491201538-33">)</span><span class="w"> </span><span class="k" data-group-id="1491201538-32">end</span><span class="w">
    </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="1491201538-34">(</span><span class="n">value</span><span class="p" data-group-id="1491201538-34">)</span><span class="w">
    
    </span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1491201538-35">(</span><span class="n">f</span><span class="p" data-group-id="1491201538-35">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1491201538-36">(</span><span class="n">g</span><span class="p" data-group-id="1491201538-36">)</span><span class="w">
    </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1491201538-37">(</span><span class="k" data-group-id="1491201538-38">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="p" data-group-id="1491201538-39">(</span><span class="n">x</span><span class="p" data-group-id="1491201538-39">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1491201538-40">(</span><span class="n">g</span><span class="p" data-group-id="1491201538-40">)</span><span class="w"> </span><span class="k" data-group-id="1491201538-38">end</span><span class="p" data-group-id="1491201538-37">)</span><span class="w">
    
    </span><span class="n">assert</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;&quot;
    Associativity law failed for </span><span class="si" data-group-id="1491201538-41">#{</span><span class="n">inspect</span><span class="p" data-group-id="1491201538-42">(</span><span class="n">monad_module</span><span class="p" data-group-id="1491201538-42">)</span><span class="si" data-group-id="1491201538-41">}</span><span class="s">
    Value: </span><span class="si" data-group-id="1491201538-43">#{</span><span class="n">inspect</span><span class="p" data-group-id="1491201538-44">(</span><span class="n">value</span><span class="p" data-group-id="1491201538-44">)</span><span class="si" data-group-id="1491201538-43">}</span><span class="s">
    &quot;&quot;&quot;</span><span class="w">
  </span><span class="k" data-group-id="1491201538-31">end</span><span class="w">
  
  </span><span class="n">test</span><span class="w"> </span><span class="s">&quot;Maybe satisfies monad laws&quot;</span><span class="w"> </span><span class="k" data-group-id="1491201538-45">do</span><span class="w">
    </span><span class="n">sample_values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="1491201538-46">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p" data-group-id="1491201538-46">]</span><span class="w">
    </span><span class="n">sample_functions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="1491201538-47">[</span><span class="w">
      </span><span class="k" data-group-id="1491201538-48">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="1491201538-49">(</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1491201538-49">)</span><span class="w"> </span><span class="k" data-group-id="1491201538-48">end</span><span class="p">,</span><span class="w">
      </span><span class="k" data-group-id="1491201538-50">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="1491201538-51">(</span><span class="n">x</span><span class="p" data-group-id="1491201538-51">)</span><span class="p">,</span><span class="w"> </span><span class="ss">else</span><span class="p">:</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="1491201538-52">(</span><span class="p" data-group-id="1491201538-52">)</span><span class="w"> </span><span class="k" data-group-id="1491201538-50">end</span><span class="p">,</span><span class="w">
      </span><span class="k" data-group-id="1491201538-53">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="1491201538-54">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="1491201538-54">)</span><span class="w"> </span><span class="k" data-group-id="1491201538-53">end</span><span class="w">
    </span><span class="p" data-group-id="1491201538-47">]</span><span class="w">
    
    </span><span class="n">test_monad_laws</span><span class="p" data-group-id="1491201538-55">(</span><span class="nc">Maybe</span><span class="p">,</span><span class="w"> </span><span class="n">sample_values</span><span class="p">,</span><span class="w"> </span><span class="n">sample_functions</span><span class="p" data-group-id="1491201538-55">)</span><span class="w">
  </span><span class="k" data-group-id="1491201538-45">end</span><span class="w">
  
  </span><span class="n">test</span><span class="w"> </span><span class="s">&quot;Either satisfies monad laws&quot;</span><span class="w"> </span><span class="k" data-group-id="1491201538-56">do</span><span class="w">
    </span><span class="n">sample_values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="1491201538-57">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="1491201538-57">]</span><span class="w">
    </span><span class="n">sample_functions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="1491201538-58">[</span><span class="w">
      </span><span class="k" data-group-id="1491201538-59">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="1491201538-60">(</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1491201538-60">)</span><span class="w"> </span><span class="k" data-group-id="1491201538-59">end</span><span class="p">,</span><span class="w">
      </span><span class="k" data-group-id="1491201538-61">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="1491201538-62">(</span><span class="n">x</span><span class="p" data-group-id="1491201538-62">)</span><span class="p">,</span><span class="w"> </span><span class="ss">else</span><span class="p">:</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">left</span><span class="p" data-group-id="1491201538-63">(</span><span class="s">&quot;negative&quot;</span><span class="p" data-group-id="1491201538-63">)</span><span class="w"> </span><span class="k" data-group-id="1491201538-61">end</span><span class="p">,</span><span class="w">
      </span><span class="k" data-group-id="1491201538-64">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="1491201538-65">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="1491201538-65">)</span><span class="w"> </span><span class="k" data-group-id="1491201538-64">end</span><span class="w">
    </span><span class="p" data-group-id="1491201538-58">]</span><span class="w">
    
    </span><span class="n">test_monad_laws</span><span class="p" data-group-id="1491201538-66">(</span><span class="nc">Either</span><span class="p">,</span><span class="w"> </span><span class="n">sample_values</span><span class="p">,</span><span class="w"> </span><span class="n">sample_functions</span><span class="p" data-group-id="1491201538-66">)</span><span class="w">
  </span><span class="k" data-group-id="1491201538-56">end</span><span class="w">
</span><span class="k" data-group-id="1491201538-1">end</span></code></pre><h3 id="test-generic-monadic-functions" class="section-heading">
  <a href="#test-generic-monadic-functions" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Test Generic Monadic Functions</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">GenericMonadTest</span><span class="w"> </span><span class="k" data-group-id="6300182936-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">ExUnit.Case</span><span class="w">
  
  </span><span class="c1"># Test that generic functions work with multiple monad types</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">generic_double_and_add</span><span class="p" data-group-id="6300182936-2">(</span><span class="n">monad_value</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p" data-group-id="6300182936-2">)</span><span class="w"> </span><span class="k" data-group-id="6300182936-3">do</span><span class="w">
    </span><span class="n">monad_value</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="6300182936-4">(</span><span class="k" data-group-id="6300182936-5">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="6300182936-6">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x * 2) end)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="6300182936-7">(</span><span class="k" data-group-id="6300182936-8">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="6300182936-9">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x + amount) end)</span><span class="w">
  </span><span class="k">end</span><span class="w">
  
  </span><span class="n">test</span><span class="w"> </span><span class="s">&quot;generic functions work with Maybe&quot;</span><span class="w"> </span><span class="k" data-group-id="6300182936-10">do</span><span class="w">
    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">generic_double_and_add</span><span class="p" data-group-id="6300182936-11">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="6300182936-12">(</span><span class="mi">5</span><span class="p" data-group-id="6300182936-12">)</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="6300182936-11">)</span><span class="w">
    </span><span class="n">assert</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="6300182936-13">(</span><span class="mi">20</span><span class="p" data-group-id="6300182936-13">)</span><span class="w">
    
    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">generic_double_and_add</span><span class="p" data-group-id="6300182936-14">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="6300182936-15">(</span><span class="p" data-group-id="6300182936-15">)</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="6300182936-14">)</span><span class="w">
    </span><span class="n">assert</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="6300182936-16">(</span><span class="p" data-group-id="6300182936-16">)</span><span class="w">
  </span><span class="k" data-group-id="6300182936-10">end</span><span class="w">
  
  </span><span class="n">test</span><span class="w"> </span><span class="s">&quot;generic functions work with Either&quot;</span><span class="w"> </span><span class="k" data-group-id="6300182936-17">do</span><span class="w">
    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">generic_double_and_add</span><span class="p" data-group-id="6300182936-18">(</span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="6300182936-19">(</span><span class="mi">5</span><span class="p" data-group-id="6300182936-19">)</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="6300182936-18">)</span><span class="w">
    </span><span class="n">assert</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="6300182936-20">(</span><span class="mi">20</span><span class="p" data-group-id="6300182936-20">)</span><span class="w">
    
    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">generic_double_and_add</span><span class="p" data-group-id="6300182936-21">(</span><span class="nc">Either</span><span class="o">.</span><span class="n">left</span><span class="p" data-group-id="6300182936-22">(</span><span class="s">&quot;error&quot;</span><span class="p" data-group-id="6300182936-22">)</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="6300182936-21">)</span><span class="w">
    </span><span class="n">assert</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">left</span><span class="p" data-group-id="6300182936-23">(</span><span class="s">&quot;error&quot;</span><span class="p" data-group-id="6300182936-23">)</span><span class="w">
  </span><span class="k" data-group-id="6300182936-17">end</span><span class="w">
  
  </span><span class="n">test</span><span class="w"> </span><span class="s">&quot;generic functions work with Identity&quot;</span><span class="w"> </span><span class="k" data-group-id="6300182936-24">do</span><span class="w">
    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">generic_double_and_add</span><span class="p" data-group-id="6300182936-25">(</span><span class="nc">Identity</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="6300182936-26">(</span><span class="mi">5</span><span class="p" data-group-id="6300182936-26">)</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p" data-group-id="6300182936-25">)</span><span class="w">
    </span><span class="n">assert</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nc">Identity</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="6300182936-27">(</span><span class="mi">20</span><span class="p" data-group-id="6300182936-27">)</span><span class="w">
  </span><span class="k" data-group-id="6300182936-24">end</span><span class="w">
</span><span class="k">end</span></code></pre><h3 id="test-join-operation" class="section-heading">
  <a href="#test-join-operation" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Test Join Operation</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MonadJoinTest</span><span class="w"> </span><span class="k" data-group-id="1568781432-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">ExUnit.Case</span><span class="w">
  
  </span><span class="n">test</span><span class="w"> </span><span class="s">&quot;join flattens nested Maybe&quot;</span><span class="w"> </span><span class="k" data-group-id="1568781432-2">do</span><span class="w">
    </span><span class="n">nested</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="1568781432-3">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="1568781432-4">(</span><span class="mi">42</span><span class="p" data-group-id="1568781432-4">)</span><span class="p" data-group-id="1568781432-3">)</span><span class="w">
    </span><span class="n">flattened</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1568781432-5">(</span><span class="n">nested</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="1568781432-6">fn</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="k" data-group-id="1568781432-6">end</span><span class="p" data-group-id="1568781432-5">)</span><span class="w">
    </span><span class="n">assert</span><span class="w"> </span><span class="n">flattened</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="1568781432-7">(</span><span class="mi">42</span><span class="p" data-group-id="1568781432-7">)</span><span class="w">
    
    </span><span class="n">nested_nothing_inner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="1568781432-8">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="1568781432-9">(</span><span class="p" data-group-id="1568781432-9">)</span><span class="p" data-group-id="1568781432-8">)</span><span class="w">
    </span><span class="n">flattened</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1568781432-10">(</span><span class="n">nested_nothing_inner</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="1568781432-11">fn</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="k" data-group-id="1568781432-11">end</span><span class="p" data-group-id="1568781432-10">)</span><span class="w">
    </span><span class="n">assert</span><span class="w"> </span><span class="n">flattened</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="1568781432-12">(</span><span class="p" data-group-id="1568781432-12">)</span><span class="w">
    
    </span><span class="n">nothing_outer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="1568781432-13">(</span><span class="p" data-group-id="1568781432-13">)</span><span class="w">
    </span><span class="n">flattened</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1568781432-14">(</span><span class="n">nothing_outer</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="1568781432-15">fn</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="k" data-group-id="1568781432-15">end</span><span class="p" data-group-id="1568781432-14">)</span><span class="w">
    </span><span class="n">assert</span><span class="w"> </span><span class="n">flattened</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="1568781432-16">(</span><span class="p" data-group-id="1568781432-16">)</span><span class="w">
  </span><span class="k" data-group-id="1568781432-2">end</span><span class="w">
  
  </span><span class="n">test</span><span class="w"> </span><span class="s">&quot;join flattens nested Either&quot;</span><span class="w"> </span><span class="k" data-group-id="1568781432-17">do</span><span class="w">
    </span><span class="n">nested_right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="1568781432-18">(</span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="1568781432-19">(</span><span class="s">&quot;success&quot;</span><span class="p" data-group-id="1568781432-19">)</span><span class="p" data-group-id="1568781432-18">)</span><span class="w">
    </span><span class="n">flattened</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1568781432-20">(</span><span class="n">nested_right</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="1568781432-21">fn</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="k" data-group-id="1568781432-21">end</span><span class="p" data-group-id="1568781432-20">)</span><span class="w">
    </span><span class="n">assert</span><span class="w"> </span><span class="n">flattened</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="1568781432-22">(</span><span class="s">&quot;success&quot;</span><span class="p" data-group-id="1568781432-22">)</span><span class="w">
    
    </span><span class="n">nested_left_inner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="1568781432-23">(</span><span class="nc">Either</span><span class="o">.</span><span class="n">left</span><span class="p" data-group-id="1568781432-24">(</span><span class="s">&quot;inner error&quot;</span><span class="p" data-group-id="1568781432-24">)</span><span class="p" data-group-id="1568781432-23">)</span><span class="w">
    </span><span class="n">flattened</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1568781432-25">(</span><span class="n">nested_left_inner</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="1568781432-26">fn</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="k" data-group-id="1568781432-26">end</span><span class="p" data-group-id="1568781432-25">)</span><span class="w">
    </span><span class="n">assert</span><span class="w"> </span><span class="n">flattened</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">left</span><span class="p" data-group-id="1568781432-27">(</span><span class="s">&quot;inner error&quot;</span><span class="p" data-group-id="1568781432-27">)</span><span class="w">
    
    </span><span class="n">left_outer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">left</span><span class="p" data-group-id="1568781432-28">(</span><span class="s">&quot;outer error&quot;</span><span class="p" data-group-id="1568781432-28">)</span><span class="w">
    </span><span class="n">flattened</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1568781432-29">(</span><span class="n">left_outer</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="1568781432-30">fn</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="k" data-group-id="1568781432-30">end</span><span class="p" data-group-id="1568781432-29">)</span><span class="w">
    </span><span class="n">assert</span><span class="w"> </span><span class="n">flattened</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">left</span><span class="p" data-group-id="1568781432-31">(</span><span class="s">&quot;outer error&quot;</span><span class="p" data-group-id="1568781432-31">)</span><span class="w">
  </span><span class="k" data-group-id="1568781432-17">end</span><span class="w">
</span><span class="k" data-group-id="1568781432-1">end</span></code></pre><h2 id="llm-debugging-tips" class="section-heading">
  <a href="#llm-debugging-tips" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">LLM Debugging Tips</span>
</h2>
<h3 id="trace-monadic-operations" class="section-heading">
  <a href="#trace-monadic-operations" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Trace Monadic Operations</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">trace_monad_operations</span><span class="p" data-group-id="7988901021-1">(</span><span class="n">monad_value</span><span class="p">,</span><span class="w"> </span><span class="n">operations</span><span class="p" data-group-id="7988901021-1">)</span><span class="w"> </span><span class="k" data-group-id="7988901021-2">do</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="7988901021-3">(</span><span class="s">&quot;Starting with: </span><span class="si" data-group-id="7988901021-4">#{</span><span class="n">inspect</span><span class="p" data-group-id="7988901021-5">(</span><span class="n">monad_value</span><span class="p" data-group-id="7988901021-5">)</span><span class="si" data-group-id="7988901021-4">}</span><span class="s">&quot;</span><span class="p" data-group-id="7988901021-3">)</span><span class="w">
  
  </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">reduce</span><span class="p" data-group-id="7988901021-6">(</span><span class="n">operations</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7988901021-7">{</span><span class="n">monad_value</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="7988901021-7">}</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="7988901021-8">fn</span><span class="w"> </span><span class="n">operation</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7988901021-9">{</span><span class="n">current</span><span class="p">,</span><span class="w"> </span><span class="n">step</span><span class="p" data-group-id="7988901021-9">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="7988901021-10">(</span><span class="s">&quot;Step </span><span class="si" data-group-id="7988901021-11">#{</span><span class="n">step</span><span class="si" data-group-id="7988901021-11">}</span><span class="s">: Input = </span><span class="si" data-group-id="7988901021-12">#{</span><span class="n">inspect</span><span class="p" data-group-id="7988901021-13">(</span><span class="n">current</span><span class="p" data-group-id="7988901021-13">)</span><span class="si" data-group-id="7988901021-12">}</span><span class="s">&quot;</span><span class="p" data-group-id="7988901021-10">)</span><span class="w">
    
    </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="k" data-group-id="7988901021-14">do</span><span class="w">
      </span><span class="p" data-group-id="7988901021-15">{</span><span class="ss">:bind</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p" data-group-id="7988901021-15">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> 
        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="7988901021-16">(</span><span class="n">current</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p" data-group-id="7988901021-16">)</span><span class="w">
        </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="7988901021-17">(</span><span class="s">&quot;Step </span><span class="si" data-group-id="7988901021-18">#{</span><span class="n">step</span><span class="si" data-group-id="7988901021-18">}</span><span class="s">: bind -&gt; </span><span class="si" data-group-id="7988901021-19">#{</span><span class="n">inspect</span><span class="p" data-group-id="7988901021-20">(</span><span class="n">result</span><span class="p" data-group-id="7988901021-20">)</span><span class="si" data-group-id="7988901021-19">}</span><span class="s">&quot;</span><span class="p" data-group-id="7988901021-17">)</span><span class="w">
        </span><span class="n">result</span><span class="w">
      </span><span class="p" data-group-id="7988901021-21">{</span><span class="ss">:map</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p" data-group-id="7988901021-21">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="7988901021-22">(</span><span class="n">current</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="7988901021-23">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="7988901021-24">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.f.(x)) end)</span><span class="w">
        </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="7988901021-25">(</span><span class="s">&quot;Step </span><span class="si" data-group-id="7988901021-26">#{</span><span class="n">step</span><span class="si" data-group-id="7988901021-26">}</span><span class="s">: map -&gt; </span><span class="si" data-group-id="7988901021-27">#{</span><span class="n">inspect</span><span class="p" data-group-id="7988901021-28">(</span><span class="n">result</span><span class="p" data-group-id="7988901021-28">)</span><span class="si" data-group-id="7988901021-27">}</span><span class="s">&quot;</span><span class="p" data-group-id="7988901021-25">)</span><span class="w">
        </span><span class="n">result</span><span class="w">
    </span><span class="k">end</span><span class="w">
    
    </span><span class="p" data-group-id="7988901021-29">{</span><span class="n">next</span><span class="p">,</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="7988901021-29">}</span><span class="w">
  </span><span class="k">end</span><span class="p" data-group-id="7988901021-24">)</span><span class="w">
  
  </span><span class="p" data-group-id="7988901021-30">{</span><span class="n">traced_result</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p" data-group-id="7988901021-30">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="7988901021-31">(</span><span class="s">&quot;Final result: </span><span class="si" data-group-id="7988901021-32">#{</span><span class="n">inspect</span><span class="p" data-group-id="7988901021-33">(</span><span class="n">traced_result</span><span class="p" data-group-id="7988901021-33">)</span><span class="si" data-group-id="7988901021-32">}</span><span class="s">&quot;</span><span class="p" data-group-id="7988901021-31">)</span><span class="w">
  </span><span class="n">traced_result</span><span class="w">
</span><span class="k" data-group-id="7988901021-23">end</span><span class="w">

</span><span class="c1"># Usage</span><span class="w">
</span><span class="n">trace_monad_operations</span><span class="p" data-group-id="7988901021-34">(</span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="7988901021-35">(</span><span class="mi">10</span><span class="p" data-group-id="7988901021-35">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7988901021-36">[</span><span class="w">
  </span><span class="p" data-group-id="7988901021-37">{</span><span class="ss">:bind</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="7988901021-38">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="7988901021-39">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="7988901021-39">)</span><span class="w"> </span><span class="k" data-group-id="7988901021-38">end</span><span class="p" data-group-id="7988901021-37">}</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="7988901021-40">{</span><span class="ss">:map</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="7988901021-41">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k" data-group-id="7988901021-41">end</span><span class="p" data-group-id="7988901021-40">}</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="7988901021-42">{</span><span class="ss">:bind</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="7988901021-43">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="7988901021-44">(</span><span class="n">x</span><span class="p" data-group-id="7988901021-44">)</span><span class="p">,</span><span class="w"> </span><span class="ss">else</span><span class="p">:</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="7988901021-45">(</span><span class="p" data-group-id="7988901021-45">)</span><span class="w"> </span><span class="k" data-group-id="7988901021-43">end</span><span class="p" data-group-id="7988901021-42">}</span><span class="w">
</span><span class="p" data-group-id="7988901021-36">]</span><span class="p" data-group-id="7988901021-34">)</span></code></pre><h3 id="verify-law-compliance" class="section-heading">
  <a href="#verify-law-compliance" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Verify Law Compliance</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">debug_monad_laws</span><span class="p" data-group-id="0303802201-1">(</span><span class="n">monad_module</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="p" data-group-id="0303802201-1">)</span><span class="w"> </span><span class="k" data-group-id="0303802201-2">do</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="0303802201-3">(</span><span class="s">&quot;Testing monad laws for </span><span class="si" data-group-id="0303802201-4">#{</span><span class="n">inspect</span><span class="p" data-group-id="0303802201-5">(</span><span class="n">monad_module</span><span class="p" data-group-id="0303802201-5">)</span><span class="si" data-group-id="0303802201-4">}</span><span class="s"> with value </span><span class="si" data-group-id="0303802201-6">#{</span><span class="n">inspect</span><span class="p" data-group-id="0303802201-7">(</span><span class="n">value</span><span class="p" data-group-id="0303802201-7">)</span><span class="si" data-group-id="0303802201-6">}</span><span class="s">&quot;</span><span class="p" data-group-id="0303802201-3">)</span><span class="w">
  
  </span><span class="c1"># Left Identity</span><span class="w">
  </span><span class="n">left_identity_left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="0303802201-8">(</span><span class="n">value</span><span class="p" data-group-id="0303802201-8">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="0303802201-9">(</span><span class="n">function</span><span class="p" data-group-id="0303802201-9">)</span><span class="w">
  </span><span class="n">left_identity_right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="p" data-group-id="0303802201-10">(</span><span class="n">value</span><span class="p" data-group-id="0303802201-10">)</span><span class="w">
  </span><span class="n">left_identity_ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">left_identity_left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">left_identity_right</span><span class="w">
  
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="0303802201-11">(</span><span class="s">&quot;Left Identity: </span><span class="si" data-group-id="0303802201-12">#{</span><span class="n">left_identity_ok</span><span class="si" data-group-id="0303802201-12">}</span><span class="s">&quot;</span><span class="p" data-group-id="0303802201-11">)</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="0303802201-13">(</span><span class="s">&quot;  return(</span><span class="si" data-group-id="0303802201-14">#{</span><span class="n">inspect</span><span class="p" data-group-id="0303802201-15">(</span><span class="n">value</span><span class="p" data-group-id="0303802201-15">)</span><span class="si" data-group-id="0303802201-14">}</span><span class="s">) &gt;&gt;= f = </span><span class="si" data-group-id="0303802201-16">#{</span><span class="n">inspect</span><span class="p" data-group-id="0303802201-17">(</span><span class="n">left_identity_left</span><span class="p" data-group-id="0303802201-17">)</span><span class="si" data-group-id="0303802201-16">}</span><span class="s">&quot;</span><span class="p" data-group-id="0303802201-13">)</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="0303802201-18">(</span><span class="s">&quot;  f(</span><span class="si" data-group-id="0303802201-19">#{</span><span class="n">inspect</span><span class="p" data-group-id="0303802201-20">(</span><span class="n">value</span><span class="p" data-group-id="0303802201-20">)</span><span class="si" data-group-id="0303802201-19">}</span><span class="s">) = </span><span class="si" data-group-id="0303802201-21">#{</span><span class="n">inspect</span><span class="p" data-group-id="0303802201-22">(</span><span class="n">left_identity_right</span><span class="p" data-group-id="0303802201-22">)</span><span class="si" data-group-id="0303802201-21">}</span><span class="s">&quot;</span><span class="p" data-group-id="0303802201-18">)</span><span class="w">
  
  </span><span class="c1"># Right Identity</span><span class="w">
  </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="0303802201-23">(</span><span class="n">value</span><span class="p" data-group-id="0303802201-23">)</span><span class="w">
  </span><span class="n">right_identity_left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="0303802201-24">(</span><span class="o">&amp;</span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="0303802201-24">)</span><span class="w">
  </span><span class="n">right_identity_right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w">
  </span><span class="n">right_identity_ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">right_identity_left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">right_identity_right</span><span class="w">
  
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="0303802201-25">(</span><span class="s">&quot;Right Identity: </span><span class="si" data-group-id="0303802201-26">#{</span><span class="n">right_identity_ok</span><span class="si" data-group-id="0303802201-26">}</span><span class="s">&quot;</span><span class="p" data-group-id="0303802201-25">)</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="0303802201-27">(</span><span class="s">&quot;  m &gt;&gt;= return = </span><span class="si" data-group-id="0303802201-28">#{</span><span class="n">inspect</span><span class="p" data-group-id="0303802201-29">(</span><span class="n">right_identity_left</span><span class="p" data-group-id="0303802201-29">)</span><span class="si" data-group-id="0303802201-28">}</span><span class="s">&quot;</span><span class="p" data-group-id="0303802201-27">)</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="0303802201-30">(</span><span class="s">&quot;  m = </span><span class="si" data-group-id="0303802201-31">#{</span><span class="n">inspect</span><span class="p" data-group-id="0303802201-32">(</span><span class="n">right_identity_right</span><span class="p" data-group-id="0303802201-32">)</span><span class="si" data-group-id="0303802201-31">}</span><span class="s">&quot;</span><span class="p" data-group-id="0303802201-30">)</span><span class="w">
  
  </span><span class="c1"># Associativity</span><span class="w">
  </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="0303802201-33">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="0303802201-34">(</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">100</span><span class="p" data-group-id="0303802201-34">)</span><span class="w"> </span><span class="k" data-group-id="0303802201-33">end</span><span class="w">
  </span><span class="n">assoc_left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="0303802201-35">(</span><span class="n">function</span><span class="p" data-group-id="0303802201-35">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="0303802201-36">(</span><span class="n">g</span><span class="p" data-group-id="0303802201-36">)</span><span class="w">
  </span><span class="n">assoc_right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="0303802201-37">(</span><span class="k" data-group-id="0303802201-38">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="p" data-group-id="0303802201-39">(</span><span class="n">x</span><span class="p" data-group-id="0303802201-39">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="0303802201-40">(</span><span class="n">g</span><span class="p" data-group-id="0303802201-40">)</span><span class="w"> </span><span class="k" data-group-id="0303802201-38">end</span><span class="p" data-group-id="0303802201-37">)</span><span class="w">
  </span><span class="n">associativity_ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">assoc_left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">assoc_right</span><span class="w">
  
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="0303802201-41">(</span><span class="s">&quot;Associativity: </span><span class="si" data-group-id="0303802201-42">#{</span><span class="n">associativity_ok</span><span class="si" data-group-id="0303802201-42">}</span><span class="s">&quot;</span><span class="p" data-group-id="0303802201-41">)</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="0303802201-43">(</span><span class="s">&quot;  (m &gt;&gt;= f) &gt;&gt;= g = </span><span class="si" data-group-id="0303802201-44">#{</span><span class="n">inspect</span><span class="p" data-group-id="0303802201-45">(</span><span class="n">assoc_left</span><span class="p" data-group-id="0303802201-45">)</span><span class="si" data-group-id="0303802201-44">}</span><span class="s">&quot;</span><span class="p" data-group-id="0303802201-43">)</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="0303802201-46">(</span><span class="s">&quot;  m &gt;&gt;= (</span><span class="se">\\</span><span class="s">x -&gt; f(x) &gt;&gt;= g) = </span><span class="si" data-group-id="0303802201-47">#{</span><span class="n">inspect</span><span class="p" data-group-id="0303802201-48">(</span><span class="n">assoc_right</span><span class="p" data-group-id="0303802201-48">)</span><span class="si" data-group-id="0303802201-47">}</span><span class="s">&quot;</span><span class="p" data-group-id="0303802201-46">)</span><span class="w">
  
  </span><span class="p" data-group-id="0303802201-49">%{</span><span class="w">
    </span><span class="ss">left_identity</span><span class="p">:</span><span class="w"> </span><span class="n">left_identity_ok</span><span class="p">,</span><span class="w">
    </span><span class="ss">right_identity</span><span class="p">:</span><span class="w"> </span><span class="n">right_identity_ok</span><span class="p">,</span><span class="w">
    </span><span class="ss">associativity</span><span class="p">:</span><span class="w"> </span><span class="n">associativity_ok</span><span class="p">,</span><span class="w">
    </span><span class="ss">all_pass</span><span class="p">:</span><span class="w"> </span><span class="n">left_identity_ok</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">right_identity_ok</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">associativity_ok</span><span class="w">
  </span><span class="p" data-group-id="0303802201-49">}</span><span class="w">
</span><span class="k" data-group-id="0303802201-2">end</span></code></pre><h3 id="monitor-performance" class="section-heading">
  <a href="#monitor-performance" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Monitor Performance</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">benchmark_monadic_operations</span><span class="p" data-group-id="9199806777-1">(</span><span class="p" data-group-id="9199806777-1">)</span><span class="w"> </span><span class="k" data-group-id="9199806777-2">do</span><span class="w">
  </span><span class="c1"># Compare protocol vs direct module performance</span><span class="w">
  </span><span class="n">test_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="9199806777-3">(</span><span class="mi">42</span><span class="p" data-group-id="9199806777-3">)</span><span class="w">
  </span><span class="n">iterations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100_000</span><span class="w">
  
  </span><span class="c1"># Protocol-based version</span><span class="w">
  </span><span class="n">protocol_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">:timer</span><span class="o">.</span><span class="n">tc</span><span class="p" data-group-id="9199806777-4">(</span><span class="k" data-group-id="9199806777-5">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="k">for</span><span class="w"> </span><span class="bp">_</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="n">iterations</span><span class="w"> </span><span class="k" data-group-id="9199806777-6">do</span><span class="w">
      </span><span class="n">test_value</span><span class="w">
      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="9199806777-7">(</span><span class="k" data-group-id="9199806777-8">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="9199806777-9">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x + 1) end)</span><span class="w">
      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="9199806777-10">(</span><span class="k" data-group-id="9199806777-11">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="9199806777-12">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x * 2) end)</span><span class="w">
    </span><span class="k">end</span><span class="w">
  </span><span class="k">end</span><span class="p" data-group-id="9199806777-12">)</span><span class="w">
  
  </span><span class="c1"># Direct module version</span><span class="w">
  </span><span class="n">direct_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">:timer</span><span class="o">.</span><span class="n">tc</span><span class="p" data-group-id="9199806777-13">(</span><span class="k" data-group-id="9199806777-14">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="k">for</span><span class="w"> </span><span class="bp">_</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="n">iterations</span><span class="w"> </span><span class="k" data-group-id="9199806777-15">do</span><span class="w">
      </span><span class="n">test_value</span><span class="w">
      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="9199806777-16">(</span><span class="k" data-group-id="9199806777-17">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="9199806777-18">(</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="9199806777-18">)</span><span class="w"> </span><span class="k" data-group-id="9199806777-17">end</span><span class="p" data-group-id="9199806777-16">)</span><span class="w">
      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="9199806777-19">(</span><span class="k" data-group-id="9199806777-20">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="9199806777-21">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="9199806777-21">)</span><span class="w"> </span><span class="k" data-group-id="9199806777-20">end</span><span class="p" data-group-id="9199806777-19">)</span><span class="w">
    </span><span class="k" data-group-id="9199806777-15">end</span><span class="w">
  </span><span class="k" data-group-id="9199806777-14">end</span><span class="p" data-group-id="9199806777-13">)</span><span class="w">
  
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="9199806777-22">(</span><span class="s">&quot;Protocol time: </span><span class="si" data-group-id="9199806777-23">#{</span><span class="n">elem</span><span class="p" data-group-id="9199806777-24">(</span><span class="n">protocol_time</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="9199806777-24">)</span><span class="si" data-group-id="9199806777-23">}</span><span class="s"> microseconds&quot;</span><span class="p" data-group-id="9199806777-22">)</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="9199806777-25">(</span><span class="s">&quot;Direct time: </span><span class="si" data-group-id="9199806777-26">#{</span><span class="n">elem</span><span class="p" data-group-id="9199806777-27">(</span><span class="n">direct_time</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="9199806777-27">)</span><span class="si" data-group-id="9199806777-26">}</span><span class="s"> microseconds&quot;</span><span class="p" data-group-id="9199806777-25">)</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="9199806777-28">(</span><span class="s">&quot;Overhead: </span><span class="si" data-group-id="9199806777-29">#{</span><span class="p" data-group-id="9199806777-30">(</span><span class="n">elem</span><span class="p" data-group-id="9199806777-31">(</span><span class="n">protocol_time</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="9199806777-31">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">elem</span><span class="p" data-group-id="9199806777-32">(</span><span class="n">direct_time</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="9199806777-32">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="9199806777-30">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si" data-group-id="9199806777-29">}</span><span class="s">%&quot;</span><span class="p" data-group-id="9199806777-28">)</span><span class="w">
</span><span class="k" data-group-id="9199806777-11">end</span></code></pre><h2 id="llm-common-mistakes-to-avoid" class="section-heading">
  <a href="#llm-common-mistakes-to-avoid" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">LLM Common Mistakes to Avoid</span>
</h2>
<h3 id="don-t-mix-protocol-and-direct-calls" class="section-heading">
  <a href="#don-t-mix-protocol-and-direct-calls" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">❌ Don't Mix Protocol and Direct Calls</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="c1"># ❌ Wrong: mixing protocol and module-specific calls</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">bad_generic_function</span><span class="p" data-group-id="5952479877-1">(</span><span class="n">monad_value</span><span class="p" data-group-id="5952479877-1">)</span><span class="w"> </span><span class="k" data-group-id="5952479877-2">do</span><span class="w">
  </span><span class="n">monad_value</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="5952479877-3">(</span><span class="k" data-group-id="5952479877-4">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="5952479877-5">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x + 1) end)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="5952479877-6">(</span><span class="k" data-group-id="5952479877-7">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k" data-group-id="5952479877-7">end</span><span class="p" data-group-id="5952479877-6">)</span><span class="w">  </span><span class="c1"># Breaks genericity!</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="5952479877-8">(</span><span class="k" data-group-id="5952479877-9">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="5952479877-10">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x - 1) end)</span><span class="w">
</span><span class="k">end</span><span class="w">

</span><span class="c1"># ✅ Correct: use protocol operations consistently  </span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">good_generic_function</span><span class="p" data-group-id="5952479877-11">(</span><span class="n">monad_value</span><span class="p" data-group-id="5952479877-11">)</span><span class="w"> </span><span class="k" data-group-id="5952479877-12">do</span><span class="w">
  </span><span class="n">monad_value</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="5952479877-13">(</span><span class="k" data-group-id="5952479877-14">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="5952479877-15">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x + 1) end)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="5952479877-16">(</span><span class="k" data-group-id="5952479877-17">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="5952479877-18">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x * 2) end)  # Map via bind + return</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="5952479877-19">(</span><span class="k" data-group-id="5952479877-20">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="5952479877-21">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x - 1) end)</span><span class="w">
</span><span class="k">end</span></code></pre><h3 id="don-t-assume-specific-monad-constructors" class="section-heading">
  <a href="#don-t-assume-specific-monad-constructors" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">❌ Don't Assume Specific Monad Constructors</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="c1"># ❌ Wrong: using specific constructors in generic code</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">bad_validate_positive</span><span class="p" data-group-id="5358941150-1">(</span><span class="n">monad_value</span><span class="p" data-group-id="5358941150-1">)</span><span class="w"> </span><span class="k" data-group-id="5358941150-2">do</span><span class="w">
  </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="5358941150-3">(</span><span class="n">monad_value</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="5358941150-4">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="5358941150-5">do</span><span class="w">
      </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="5358941150-6">(</span><span class="n">x</span><span class="p" data-group-id="5358941150-6">)</span><span class="w">  </span><span class="c1"># Assumes Maybe monad!</span><span class="w">
    </span><span class="k" data-group-id="5358941150-5">else</span><span class="w">
      </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="5358941150-7">(</span><span class="p" data-group-id="5358941150-7">)</span><span class="w">
    </span><span class="k" data-group-id="5358941150-5">end</span><span class="w">
  </span><span class="k" data-group-id="5358941150-4">end</span><span class="p" data-group-id="5358941150-3">)</span><span class="w">
</span><span class="k" data-group-id="5358941150-2">end</span><span class="w">

</span><span class="c1"># ✅ Correct: use protocol operations and pass monad module</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">good_validate_positive</span><span class="p" data-group-id="5358941150-8">(</span><span class="n">monad_value</span><span class="p">,</span><span class="w"> </span><span class="n">monad_module</span><span class="p" data-group-id="5358941150-8">)</span><span class="w"> </span><span class="k" data-group-id="5358941150-9">do</span><span class="w">
  </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="5358941150-10">(</span><span class="n">monad_value</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="5358941150-11">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="5358941150-12">do</span><span class="w">
      </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="5358941150-13">(</span><span class="n">x</span><span class="p" data-group-id="5358941150-13">)</span><span class="w">
    </span><span class="k" data-group-id="5358941150-12">else</span><span class="w">
      </span><span class="n">monad_module</span><span class="o">.</span><span class="n">empty</span><span class="p" data-group-id="5358941150-14">(</span><span class="p" data-group-id="5358941150-14">)</span><span class="w">  </span><span class="c1"># Assumes empty/error constructor</span><span class="w">
    </span><span class="k" data-group-id="5358941150-12">end</span><span class="w">
  </span><span class="k" data-group-id="5358941150-11">end</span><span class="p" data-group-id="5358941150-10">)</span><span class="w">
</span><span class="k" data-group-id="5358941150-9">end</span></code></pre><h3 id="don-t-ignore-monad-laws" class="section-heading">
  <a href="#don-t-ignore-monad-laws" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">❌ Don't Ignore Monad Laws</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="c1"># ❌ Wrong: implementing bind that violates laws</span><span class="w">
</span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">BadMonad</span><span class="w"> </span><span class="k" data-group-id="9109440761-1">do</span><span class="w">
  </span><span class="kd">defstruct</span><span class="w"> </span><span class="p" data-group-id="9109440761-2">[</span><span class="ss">:value</span><span class="p">,</span><span class="w"> </span><span class="ss">:extra</span><span class="p" data-group-id="9109440761-2">]</span><span class="w">
  
  </span><span class="kd">defimpl</span><span class="w"> </span><span class="nc">Funx.Monad</span><span class="w"> </span><span class="k" data-group-id="9109440761-3">do</span><span class="w">
    </span><span class="kd">def</span><span class="w"> </span><span class="nf">bind</span><span class="p" data-group-id="9109440761-4">(</span><span class="p" data-group-id="9109440761-5">%</span><span class="nc" data-group-id="9109440761-5">BadMonad</span><span class="p" data-group-id="9109440761-5">{</span><span class="ss">value</span><span class="p">:</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="ss">extra</span><span class="p">:</span><span class="w"> </span><span class="n">extra</span><span class="p" data-group-id="9109440761-5">}</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p" data-group-id="9109440761-4">)</span><span class="w"> </span><span class="k" data-group-id="9109440761-6">do</span><span class="w">
      </span><span class="c1"># This breaks associativity by adding extra each time!</span><span class="w">
      </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="p" data-group-id="9109440761-7">(</span><span class="n">value</span><span class="p" data-group-id="9109440761-7">)</span><span class="w">
      </span><span class="p" data-group-id="9109440761-8">%{</span><span class="n">result</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="ss">extra</span><span class="p">:</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="9109440761-8">}</span><span class="w">
    </span><span class="k" data-group-id="9109440761-6">end</span><span class="w">
    
    </span><span class="kd">def</span><span class="w"> </span><span class="nf">return</span><span class="p" data-group-id="9109440761-9">(</span><span class="n">value</span><span class="p" data-group-id="9109440761-9">)</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9109440761-10">%</span><span class="nc" data-group-id="9109440761-10">BadMonad</span><span class="p" data-group-id="9109440761-10">{</span><span class="ss">value</span><span class="p">:</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="ss">extra</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="9109440761-10">}</span><span class="w">
    </span><span class="kd">def</span><span class="w"> </span><span class="nf">join</span><span class="p" data-group-id="9109440761-11">(</span><span class="p" data-group-id="9109440761-12">%</span><span class="nc" data-group-id="9109440761-12">BadMonad</span><span class="p" data-group-id="9109440761-12">{</span><span class="ss">value</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9109440761-13">%</span><span class="nc" data-group-id="9109440761-13">BadMonad</span><span class="p" data-group-id="9109440761-13">{</span><span class="p" data-group-id="9109440761-13">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inner</span><span class="p" data-group-id="9109440761-12">}</span><span class="p" data-group-id="9109440761-11">)</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="n">inner</span><span class="w">
  </span><span class="k" data-group-id="9109440761-3">end</span><span class="w">
</span><span class="k" data-group-id="9109440761-1">end</span><span class="w">

</span><span class="c1"># ✅ Correct: law-abiding implementation</span><span class="w">
</span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">GoodMonad</span><span class="w"> </span><span class="k" data-group-id="9109440761-14">do</span><span class="w">
  </span><span class="kd">defstruct</span><span class="w"> </span><span class="p" data-group-id="9109440761-15">[</span><span class="ss">:value</span><span class="p" data-group-id="9109440761-15">]</span><span class="w">
  
  </span><span class="kd">defimpl</span><span class="w"> </span><span class="nc">Funx.Monad</span><span class="w"> </span><span class="k" data-group-id="9109440761-16">do</span><span class="w">
    </span><span class="kd">def</span><span class="w"> </span><span class="nf">bind</span><span class="p" data-group-id="9109440761-17">(</span><span class="p" data-group-id="9109440761-18">%</span><span class="nc" data-group-id="9109440761-18">GoodMonad</span><span class="p" data-group-id="9109440761-18">{</span><span class="ss">value</span><span class="p">:</span><span class="w"> </span><span class="n">value</span><span class="p" data-group-id="9109440761-18">}</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p" data-group-id="9109440761-17">)</span><span class="w"> </span><span class="k" data-group-id="9109440761-19">do</span><span class="w">
      </span><span class="n">f</span><span class="o">.</span><span class="p" data-group-id="9109440761-20">(</span><span class="n">value</span><span class="p" data-group-id="9109440761-20">)</span><span class="w">  </span><span class="c1"># Simple, law-abiding bind</span><span class="w">
    </span><span class="k" data-group-id="9109440761-19">end</span><span class="w">
    
    </span><span class="kd">def</span><span class="w"> </span><span class="nf">return</span><span class="p" data-group-id="9109440761-21">(</span><span class="n">value</span><span class="p" data-group-id="9109440761-21">)</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9109440761-22">%</span><span class="nc" data-group-id="9109440761-22">GoodMonad</span><span class="p" data-group-id="9109440761-22">{</span><span class="ss">value</span><span class="p">:</span><span class="w"> </span><span class="n">value</span><span class="p" data-group-id="9109440761-22">}</span><span class="w">
    </span><span class="kd">def</span><span class="w"> </span><span class="nf">join</span><span class="p" data-group-id="9109440761-23">(</span><span class="p" data-group-id="9109440761-24">%</span><span class="nc" data-group-id="9109440761-24">GoodMonad</span><span class="p" data-group-id="9109440761-24">{</span><span class="ss">value</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="9109440761-25">%</span><span class="nc" data-group-id="9109440761-25">GoodMonad</span><span class="p" data-group-id="9109440761-25">{</span><span class="p" data-group-id="9109440761-25">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inner</span><span class="p" data-group-id="9109440761-24">}</span><span class="p" data-group-id="9109440761-23">)</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="n">inner</span><span class="w">
  </span><span class="k" data-group-id="9109440761-16">end</span><span class="w">
</span><span class="k" data-group-id="9109440761-14">end</span></code></pre><h3 id="don-t-use-return-inside-bind-unnecessarily" class="section-heading">
  <a href="#don-t-use-return-inside-bind-unnecessarily" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">❌ Don't Use Return Inside Bind Unnecessarily</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="c1"># ❌ Wrong: unnecessary return wrapping</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">bad_chain</span><span class="p" data-group-id="4620694048-1">(</span><span class="n">monad_value</span><span class="p" data-group-id="4620694048-1">)</span><span class="w"> </span><span class="k" data-group-id="4620694048-2">do</span><span class="w">
  </span><span class="n">monad_value</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="4620694048-3">(</span><span class="k" data-group-id="4620694048-4">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="4620694048-5">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.result)  # This is just map!</span><span class="w">
  </span><span class="k">end</span><span class="p" data-group-id="4620694048-5">)</span><span class="w">
</span><span class="k" data-group-id="4620694048-4">end</span><span class="w">

</span><span class="c1"># ✅ Better: recognize this is mapping, not binding</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">good_chain</span><span class="p" data-group-id="4620694048-6">(</span><span class="n">monad_value</span><span class="p" data-group-id="4620694048-6">)</span><span class="w"> </span><span class="k" data-group-id="4620694048-7">do</span><span class="w">
  </span><span class="c1"># If your monad has map, use it</span><span class="w">
  </span><span class="n">monad_value</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">SomeMonad</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="4620694048-8">(</span><span class="k" data-group-id="4620694048-9">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k" data-group-id="4620694048-9">end</span><span class="p" data-group-id="4620694048-8">)</span><span class="w">
  
  </span><span class="c1"># Or if you need generic protocol:</span><span class="w">
  </span><span class="n">monad_value</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="4620694048-10">(</span><span class="k" data-group-id="4620694048-11">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="4620694048-12">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x + 1) end)</span><span class="w">
</span><span class="k">end</span><span class="w">

</span><span class="c1"># ✅ Best: only use bind when you need to flatten</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">best_chain</span><span class="p" data-group-id="4620694048-13">(</span><span class="n">monad_value</span><span class="p" data-group-id="4620694048-13">)</span><span class="w"> </span><span class="k" data-group-id="4620694048-14">do</span><span class="w">
  </span><span class="n">monad_value</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="4620694048-15">(</span><span class="k" data-group-id="4620694048-16">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="c1"># This function returns a monad, so bind is correct</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="4620694048-17">do</span><span class="w">
      </span><span class="nc">SomeSpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="4620694048-18">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x)</span><span class="w">
    </span><span class="k">else</span><span class="w">
      </span><span class="nc">SomeMonad</span><span class="o">.</span><span class="n">empty</span><span class="p" data-group-id="4620694048-19">(</span><span class="p" data-group-id="4620694048-19">)</span><span class="w">
    </span><span class="k">end</span><span class="w">
  </span><span class="k">end</span><span class="p" data-group-id="4620694048-18">)</span><span class="w">
</span><span class="k" data-group-id="4620694048-17">end</span></code></pre><h3 id="don-t-nest-binds-when-you-can-chain" class="section-heading">
  <a href="#don-t-nest-binds-when-you-can-chain" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">❌ Don't Nest Binds When You Can Chain</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="c1"># ❌ Wrong: nested bind calls (hard to read)</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">bad_nested_operations</span><span class="p" data-group-id="1958617000-1">(</span><span class="n">monad_value</span><span class="p" data-group-id="1958617000-1">)</span><span class="w"> </span><span class="k" data-group-id="1958617000-2">do</span><span class="w">
  </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1958617000-3">(</span><span class="n">monad_value</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="1958617000-4">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1958617000-5">(</span><span class="nc">SomeSpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="1958617000-6">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x + 1), fn y -&gt;</span><span class="w">
      </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1958617000-7">(</span><span class="nc">SomeSpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="1958617000-8">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.y * 2), fn z -&gt;</span><span class="w">
        </span><span class="nc">SomeSpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="1958617000-9">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.z - 1)</span><span class="w">
      </span><span class="k">end</span><span class="p" data-group-id="1958617000-9">)</span><span class="w">
    </span><span class="k">end</span><span class="p" data-group-id="1958617000-8">)</span><span class="w">
  </span><span class="k">end</span><span class="p" data-group-id="1958617000-7">)</span><span class="w">
</span><span class="k">end</span><span class="w">

</span><span class="c1"># ✅ Correct: chain bind operations with pipe</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">good_chained_operations</span><span class="p" data-group-id="1958617000-10">(</span><span class="n">monad_value</span><span class="p" data-group-id="1958617000-10">)</span><span class="w"> </span><span class="k" data-group-id="1958617000-11">do</span><span class="w">
  </span><span class="n">monad_value</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1958617000-12">(</span><span class="k" data-group-id="1958617000-13">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SomeSpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="1958617000-14">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x + 1) end)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1958617000-15">(</span><span class="k" data-group-id="1958617000-16">fn</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SomeSpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="1958617000-17">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.y * 2) end) </span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1958617000-18">(</span><span class="k" data-group-id="1958617000-19">fn</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SomeSpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="1958617000-20">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.z - 1) end)</span><span class="w">
</span><span class="k">end</span></code></pre><h3 id="don-t-forget-error-propagation" class="section-heading">
  <a href="#don-t-forget-error-propagation" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">❌ Don't Forget Error Propagation</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="c1"># ❌ Wrong: not handling error cases in generic code</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">bad_error_handling</span><span class="p" data-group-id="8232340977-1">(</span><span class="n">monad_value</span><span class="p" data-group-id="8232340977-1">)</span><span class="w"> </span><span class="k" data-group-id="8232340977-2">do</span><span class="w">
  </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="8232340977-3">(</span><span class="n">monad_value</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="8232340977-4">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="c1"># What if this operation can fail?</span><span class="w">
    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">risky_operation</span><span class="p" data-group-id="8232340977-5">(</span><span class="n">x</span><span class="p" data-group-id="8232340977-5">)</span><span class="w">  </span><span class="c1"># Might raise exception</span><span class="w">
    </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="8232340977-6">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.result)</span><span class="w">
  </span><span class="k">end</span><span class="p" data-group-id="8232340977-6">)</span><span class="w">
</span><span class="k" data-group-id="8232340977-4">end</span><span class="w">

</span><span class="c1"># ✅ Correct: handle errors appropriately</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">good_error_handling</span><span class="p" data-group-id="8232340977-7">(</span><span class="n">monad_value</span><span class="p">,</span><span class="w"> </span><span class="n">monad_module</span><span class="p" data-group-id="8232340977-7">)</span><span class="w"> </span><span class="k" data-group-id="8232340977-8">do</span><span class="w">
  </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="8232340977-9">(</span><span class="n">monad_value</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="8232340977-10">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="k">try</span><span class="w"> </span><span class="k" data-group-id="8232340977-11">do</span><span class="w">
      </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">risky_operation</span><span class="p" data-group-id="8232340977-12">(</span><span class="n">x</span><span class="p" data-group-id="8232340977-12">)</span><span class="w">
      </span><span class="n">monad_module</span><span class="o">.</span><span class="n">return</span><span class="p" data-group-id="8232340977-13">(</span><span class="n">result</span><span class="p" data-group-id="8232340977-13">)</span><span class="w">
    </span><span class="k" data-group-id="8232340977-11">rescue</span><span class="w">
      </span><span class="n">error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">monad_module</span><span class="o">.</span><span class="n">error</span><span class="p" data-group-id="8232340977-14">(</span><span class="s">&quot;operation failed: </span><span class="si" data-group-id="8232340977-15">#{</span><span class="n">inspect</span><span class="p" data-group-id="8232340977-16">(</span><span class="n">error</span><span class="p" data-group-id="8232340977-16">)</span><span class="si" data-group-id="8232340977-15">}</span><span class="s">&quot;</span><span class="p" data-group-id="8232340977-14">)</span><span class="w">
    </span><span class="k" data-group-id="8232340977-11">end</span><span class="w">
  </span><span class="k" data-group-id="8232340977-10">end</span><span class="p" data-group-id="8232340977-9">)</span><span class="w">
</span><span class="k" data-group-id="8232340977-8">end</span></code></pre><h2 id="llm-integration-with-other-modules" class="section-heading">
  <a href="#llm-integration-with-other-modules" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">LLM Integration with Other Modules</span>
</h2>
<h3 id="with-predicate-logic" class="section-heading">
  <a href="#with-predicate-logic" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">With Predicate Logic</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">build_predicate_monadic_filters</span><span class="p" data-group-id="1773060662-1">(</span><span class="p" data-group-id="1773060662-1">)</span><span class="w"> </span><span class="k" data-group-id="1773060662-2">do</span><span class="w">
  </span><span class="c1"># Combine predicates with monadic validation</span><span class="w">
  
  </span><span class="c1"># Create monadic validators from predicates</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">predicate_to_monad_validator</span><span class="p" data-group-id="1773060662-3">(</span><span class="n">predicate</span><span class="p">,</span><span class="w"> </span><span class="n">error_msg</span><span class="p" data-group-id="1773060662-3">)</span><span class="w"> </span><span class="k" data-group-id="1773060662-4">do</span><span class="w">
    </span><span class="k" data-group-id="1773060662-5">fn</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="nc">Predicate</span><span class="o">.</span><span class="n">test</span><span class="p" data-group-id="1773060662-6">(</span><span class="n">predicate</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p" data-group-id="1773060662-6">)</span><span class="w"> </span><span class="k" data-group-id="1773060662-7">do</span><span class="w">
        </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="1773060662-8">(</span><span class="n">value</span><span class="p" data-group-id="1773060662-8">)</span><span class="w">
      </span><span class="k" data-group-id="1773060662-7">else</span><span class="w">
        </span><span class="nc">Either</span><span class="o">.</span><span class="n">left</span><span class="p" data-group-id="1773060662-9">(</span><span class="n">error_msg</span><span class="p" data-group-id="1773060662-9">)</span><span class="w">
      </span><span class="k" data-group-id="1773060662-7">end</span><span class="w">
    </span><span class="k" data-group-id="1773060662-5">end</span><span class="w">
  </span><span class="k" data-group-id="1773060662-4">end</span><span class="w">
  
  </span><span class="c1"># Build complex validation chains</span><span class="w">
  </span><span class="n">age_predicate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Predicate.Utils</span><span class="o">.</span><span class="n">and_all</span><span class="p" data-group-id="1773060662-10">(</span><span class="p" data-group-id="1773060662-11">[</span><span class="w">
    </span><span class="nc">Predicate.Utils</span><span class="o">.</span><span class="n">greater_than</span><span class="p" data-group-id="1773060662-12">(</span><span class="mi">0</span><span class="p" data-group-id="1773060662-12">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">Predicate.Utils</span><span class="o">.</span><span class="n">less_than</span><span class="p" data-group-id="1773060662-13">(</span><span class="mi">150</span><span class="p" data-group-id="1773060662-13">)</span><span class="w">
  </span><span class="p" data-group-id="1773060662-11">]</span><span class="p" data-group-id="1773060662-10">)</span><span class="w">
  
  </span><span class="n">email_predicate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Predicate.Utils</span><span class="o">.</span><span class="n">matches</span><span class="p" data-group-id="1773060662-14">(</span><span class="sr">~r/@/</span><span class="p" data-group-id="1773060662-14">)</span><span class="w">
  
  </span><span class="n">validators</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="1773060662-15">%{</span><span class="w">
    </span><span class="ss">age</span><span class="p">:</span><span class="w"> </span><span class="n">predicate_to_monad_validator</span><span class="p" data-group-id="1773060662-16">(</span><span class="n">age_predicate</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;invalid age&quot;</span><span class="p" data-group-id="1773060662-16">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">email</span><span class="p">:</span><span class="w"> </span><span class="n">predicate_to_monad_validator</span><span class="p" data-group-id="1773060662-17">(</span><span class="n">email_predicate</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;invalid email&quot;</span><span class="p" data-group-id="1773060662-17">)</span><span class="w">
  </span><span class="p" data-group-id="1773060662-15">}</span><span class="w">
  
  </span><span class="c1"># Use in monadic pipeline</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">validate_user</span><span class="p" data-group-id="1773060662-18">(</span><span class="n">user_data</span><span class="p" data-group-id="1773060662-18">)</span><span class="w"> </span><span class="k" data-group-id="1773060662-19">do</span><span class="w">
    </span><span class="p" data-group-id="1773060662-20">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">user_data</span><span class="p" data-group-id="1773060662-20">}</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">from_result</span><span class="p" data-group-id="1773060662-21">(</span><span class="p" data-group-id="1773060662-21">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1773060662-22">(</span><span class="k" data-group-id="1773060662-23">fn</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="n">validators</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="p" data-group-id="1773060662-24">(</span><span class="n">data</span><span class="o">.</span><span class="n">age</span><span class="p" data-group-id="1773060662-24">)</span><span class="w">
      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1773060662-25">(</span><span class="k" data-group-id="1773060662-26">fn</span><span class="w"> </span><span class="bp">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">validators</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="p" data-group-id="1773060662-27">(</span><span class="n">data</span><span class="o">.</span><span class="n">email</span><span class="p" data-group-id="1773060662-27">)</span><span class="p">)</span><span class="w">
      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="1773060662-28">(</span><span class="k" data-group-id="1773060662-29">fn</span><span class="w"> </span><span class="bp">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="1773060662-30">(</span><span class="n">data</span><span class="p" data-group-id="1773060662-30">)</span><span class="p">)</span><span class="w">
    </span><span class="k" data-group-id="1773060662-29">end</span><span class="p" data-group-id="1773060662-28">)</span><span class="w">
  </span><span class="k" data-group-id="1773060662-26">end</span><span class="w">
  
  </span><span class="n">validate_user</span><span class="p" data-group-id="1773060662-31">(</span><span class="p" data-group-id="1773060662-32">%{</span><span class="ss">age</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="ss">email</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;user@example.com&quot;</span><span class="p" data-group-id="1773060662-32">}</span><span class="p" data-group-id="1773060662-31">)</span><span class="w">
</span><span class="k">end</span></code></pre><h3 id="with-utils-currying" class="section-heading">
  <a href="#with-utils-currying" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">With Utils Currying</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">build_curried_monadic_operations</span><span class="p" data-group-id="7109521601-1">(</span><span class="p" data-group-id="7109521601-1">)</span><span class="w"> </span><span class="k" data-group-id="7109521601-2">do</span><span class="w">
  </span><span class="c1"># Create curried monadic operations for pipeline use</span><span class="w">
  
  </span><span class="c1"># Curry bind for different argument orders</span><span class="w">
  </span><span class="n">bind_with_fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Funx.Utils</span><span class="o">.</span><span class="n">curry_r</span><span class="p" data-group-id="7109521601-3">(</span><span class="o">&amp;</span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="o">/</span><span class="mi">2</span><span class="p" data-group-id="7109521601-3">)</span><span class="w">
  </span><span class="n">bind_with_monad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Funx.Utils</span><span class="o">.</span><span class="n">curry</span><span class="p" data-group-id="7109521601-4">(</span><span class="o">&amp;</span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="o">/</span><span class="mi">2</span><span class="p" data-group-id="7109521601-4">)</span><span class="w">
  
  </span><span class="c1"># Create reusable monadic transformations</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">create_transformers</span><span class="p" data-group-id="7109521601-5">(</span><span class="p" data-group-id="7109521601-5">)</span><span class="w"> </span><span class="k" data-group-id="7109521601-6">do</span><span class="w">
    </span><span class="p" data-group-id="7109521601-7">%{</span><span class="w">
      </span><span class="ss">validate_positive</span><span class="p">:</span><span class="w"> </span><span class="n">bind_with_fn</span><span class="o">.</span><span class="p" data-group-id="7109521601-8">(</span><span class="k" data-group-id="7109521601-9">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="7109521601-10">do</span><span class="w">
          </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="7109521601-11">(</span><span class="n">x</span><span class="p" data-group-id="7109521601-11">)</span><span class="w">
        </span><span class="k" data-group-id="7109521601-10">else</span><span class="w">
          </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="7109521601-12">(</span><span class="p" data-group-id="7109521601-12">)</span><span class="w">
        </span><span class="k" data-group-id="7109521601-10">end</span><span class="w">
      </span><span class="k" data-group-id="7109521601-9">end</span><span class="p" data-group-id="7109521601-8">)</span><span class="p">,</span><span class="w">
      
      </span><span class="ss">safe_divide_by</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="7109521601-13">fn</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="n">bind_with_fn</span><span class="o">.</span><span class="p" data-group-id="7109521601-14">(</span><span class="k" data-group-id="7109521601-15">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
          </span><span class="k">if</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k" data-group-id="7109521601-16">do</span><span class="w">
            </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="7109521601-17">(</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">divisor</span><span class="p" data-group-id="7109521601-17">)</span><span class="w">
          </span><span class="k" data-group-id="7109521601-16">else</span><span class="w">
            </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="7109521601-18">(</span><span class="p" data-group-id="7109521601-18">)</span><span class="w">
          </span><span class="k" data-group-id="7109521601-16">end</span><span class="w">
        </span><span class="k" data-group-id="7109521601-15">end</span><span class="p" data-group-id="7109521601-14">)</span><span class="w">
      </span><span class="k" data-group-id="7109521601-13">end</span><span class="p">,</span><span class="w">
      
      </span><span class="ss">transform_with</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="7109521601-19">fn</span><span class="w"> </span><span class="n">transformer</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="n">bind_with_fn</span><span class="o">.</span><span class="p" data-group-id="7109521601-20">(</span><span class="k" data-group-id="7109521601-21">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
          </span><span class="k">try</span><span class="w"> </span><span class="k" data-group-id="7109521601-22">do</span><span class="w">
            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformer</span><span class="o">.</span><span class="p" data-group-id="7109521601-23">(</span><span class="n">x</span><span class="p" data-group-id="7109521601-23">)</span><span class="w">
            </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="7109521601-24">(</span><span class="n">result</span><span class="p" data-group-id="7109521601-24">)</span><span class="w">
          </span><span class="k" data-group-id="7109521601-22">rescue</span><span class="w">
            </span><span class="bp">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="7109521601-25">(</span><span class="p" data-group-id="7109521601-25">)</span><span class="w">
          </span><span class="k" data-group-id="7109521601-22">end</span><span class="w">
        </span><span class="k" data-group-id="7109521601-21">end</span><span class="p" data-group-id="7109521601-20">)</span><span class="w">
      </span><span class="k" data-group-id="7109521601-19">end</span><span class="w">
    </span><span class="p" data-group-id="7109521601-7">}</span><span class="w">
  </span><span class="k" data-group-id="7109521601-6">end</span><span class="w">
  
  </span><span class="c1"># Use in functional pipelines</span><span class="w">
  </span><span class="n">transformers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_transformers</span><span class="p" data-group-id="7109521601-26">(</span><span class="p" data-group-id="7109521601-26">)</span><span class="w">
  
  </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="7109521601-27">(</span><span class="mi">42</span><span class="p" data-group-id="7109521601-27">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">transformers</span><span class="o">.</span><span class="n">validate_positive</span><span class="o">.</span><span class="p" data-group-id="7109521601-28">(</span><span class="p" data-group-id="7109521601-28">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">transformers</span><span class="o">.</span><span class="n">safe_divide_by</span><span class="o">.</span><span class="p" data-group-id="7109521601-29">(</span><span class="mi">6</span><span class="p" data-group-id="7109521601-29">)</span><span class="o">.</span><span class="p" data-group-id="7109521601-30">(</span><span class="p" data-group-id="7109521601-30">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">transformers</span><span class="o">.</span><span class="n">transform_with</span><span class="o">.</span><span class="p" data-group-id="7109521601-31">(</span><span class="o">&amp;</span><span class="n">round</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="7109521601-31">)</span><span class="o">.</span><span class="p" data-group-id="7109521601-32">(</span><span class="p" data-group-id="7109521601-32">)</span><span class="w">
</span><span class="k" data-group-id="7109521601-2">end</span></code></pre><h3 id="with-eq-for-custom-equality" class="section-heading">
  <a href="#with-eq-for-custom-equality" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">With Eq for Custom Equality</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">build_monadic_equality_operations</span><span class="p" data-group-id="5820523982-1">(</span><span class="p" data-group-id="5820523982-1">)</span><span class="w"> </span><span class="k" data-group-id="5820523982-2">do</span><span class="w">
  </span><span class="c1"># Use custom Eq instances in monadic contexts</span><span class="w">
  
  </span><span class="c1"># Create monadic equality testers</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">create_equality_validators</span><span class="p" data-group-id="5820523982-3">(</span><span class="n">eq_instance</span><span class="p" data-group-id="5820523982-3">)</span><span class="w"> </span><span class="k" data-group-id="5820523982-4">do</span><span class="w">
    </span><span class="p" data-group-id="5820523982-5">%{</span><span class="w">
      </span><span class="ss">equals</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="5820523982-6">fn</span><span class="w"> </span><span class="n">expected_value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="k" data-group-id="5820523982-7">fn</span><span class="w"> </span><span class="n">monad_value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
          </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="5820523982-8">(</span><span class="n">monad_value</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="5820523982-9">fn</span><span class="w"> </span><span class="n">actual_value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
            </span><span class="k">if</span><span class="w"> </span><span class="nc">Eq.Utils</span><span class="o">.</span><span class="n">eq?</span><span class="p" data-group-id="5820523982-10">(</span><span class="n">actual_value</span><span class="p">,</span><span class="w"> </span><span class="n">expected_value</span><span class="p">,</span><span class="w"> </span><span class="n">eq_instance</span><span class="p" data-group-id="5820523982-10">)</span><span class="w"> </span><span class="k" data-group-id="5820523982-11">do</span><span class="w">
              </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="5820523982-12">(</span><span class="n">actual_value</span><span class="p" data-group-id="5820523982-12">)</span><span class="w">
            </span><span class="k" data-group-id="5820523982-11">else</span><span class="w">
              </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="5820523982-13">(</span><span class="p" data-group-id="5820523982-13">)</span><span class="w">
            </span><span class="k" data-group-id="5820523982-11">end</span><span class="w">
          </span><span class="k" data-group-id="5820523982-9">end</span><span class="p" data-group-id="5820523982-8">)</span><span class="w">
        </span><span class="k" data-group-id="5820523982-7">end</span><span class="w">
      </span><span class="k" data-group-id="5820523982-6">end</span><span class="p">,</span><span class="w">
      
      </span><span class="ss">not_equals</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="5820523982-14">fn</span><span class="w"> </span><span class="n">forbidden_value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="k" data-group-id="5820523982-15">fn</span><span class="w"> </span><span class="n">monad_value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
          </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="5820523982-16">(</span><span class="n">monad_value</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="5820523982-17">fn</span><span class="w"> </span><span class="n">actual_value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
            </span><span class="k">if</span><span class="w"> </span><span class="nc">Eq.Utils</span><span class="o">.</span><span class="n">not_eq?</span><span class="p" data-group-id="5820523982-18">(</span><span class="n">actual_value</span><span class="p">,</span><span class="w"> </span><span class="n">forbidden_value</span><span class="p">,</span><span class="w"> </span><span class="n">eq_instance</span><span class="p" data-group-id="5820523982-18">)</span><span class="w"> </span><span class="k" data-group-id="5820523982-19">do</span><span class="w">
              </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="5820523982-20">(</span><span class="n">actual_value</span><span class="p" data-group-id="5820523982-20">)</span><span class="w">
            </span><span class="k" data-group-id="5820523982-19">else</span><span class="w">
              </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">nothing</span><span class="p" data-group-id="5820523982-21">(</span><span class="p" data-group-id="5820523982-21">)</span><span class="w">
            </span><span class="k" data-group-id="5820523982-19">end</span><span class="w">
          </span><span class="k" data-group-id="5820523982-17">end</span><span class="p" data-group-id="5820523982-16">)</span><span class="w">
        </span><span class="k" data-group-id="5820523982-15">end</span><span class="w">
      </span><span class="k" data-group-id="5820523982-14">end</span><span class="w">
    </span><span class="p" data-group-id="5820523982-5">}</span><span class="w">
  </span><span class="k" data-group-id="5820523982-4">end</span><span class="w">
  
  </span><span class="c1"># Use with custom Eq instances</span><span class="w">
  </span><span class="n">by_id_eq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Eq.Utils</span><span class="o">.</span><span class="n">contramap</span><span class="p" data-group-id="5820523982-22">(</span><span class="k" data-group-id="5820523982-23">fn</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="w"> </span><span class="k" data-group-id="5820523982-23">end</span><span class="p" data-group-id="5820523982-22">)</span><span class="w">
  </span><span class="n">validators</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_equality_validators</span><span class="p" data-group-id="5820523982-24">(</span><span class="n">by_id_eq</span><span class="p" data-group-id="5820523982-24">)</span><span class="w">
  
  </span><span class="n">target_user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5820523982-25">%{</span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p" data-group-id="5820523982-25">}</span><span class="w">
  </span><span class="n">forbidden_user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5820523982-26">%{</span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="mi">999</span><span class="p">,</span><span class="w"> </span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Admin&quot;</span><span class="p" data-group-id="5820523982-26">}</span><span class="w">
  
  </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="5820523982-27">(</span><span class="p" data-group-id="5820523982-28">%{</span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice Updated&quot;</span><span class="p" data-group-id="5820523982-28">}</span><span class="p" data-group-id="5820523982-27">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">validators</span><span class="o">.</span><span class="n">equals</span><span class="o">.</span><span class="p" data-group-id="5820523982-29">(</span><span class="n">target_user</span><span class="p" data-group-id="5820523982-29">)</span><span class="o">.</span><span class="p" data-group-id="5820523982-30">(</span><span class="p" data-group-id="5820523982-30">)</span><span class="w">  </span><span class="c1"># Passes (same ID)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">validators</span><span class="o">.</span><span class="n">not_equals</span><span class="o">.</span><span class="p" data-group-id="5820523982-31">(</span><span class="n">forbidden_user</span><span class="p" data-group-id="5820523982-31">)</span><span class="o">.</span><span class="p" data-group-id="5820523982-32">(</span><span class="p" data-group-id="5820523982-32">)</span><span class="w">  </span><span class="c1"># Passes (different ID)</span><span class="w">
</span><span class="k" data-group-id="5820523982-2">end</span></code></pre><h3 id="cross-module-composition" class="section-heading">
  <a href="#cross-module-composition" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Cross-Module Composition</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">build_comprehensive_pipeline</span><span class="p" data-group-id="2854050193-1">(</span><span class="p" data-group-id="2854050193-1">)</span><span class="w"> </span><span class="k" data-group-id="2854050193-2">do</span><span class="w">
  </span><span class="c1"># Combine Monad, Predicate, Utils, and Eq in one pipeline</span><span class="w">
  
  </span><span class="c1"># Setup components</span><span class="w">
  </span><span class="n">age_predicate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Predicate.Utils</span><span class="o">.</span><span class="n">between</span><span class="p" data-group-id="2854050193-3">(</span><span class="mi">18</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p" data-group-id="2854050193-3">)</span><span class="w">
  </span><span class="n">email_predicate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Predicate.Utils</span><span class="o">.</span><span class="n">matches</span><span class="p" data-group-id="2854050193-4">(</span><span class="sr">~r/</span><span class="se">\A</span><span class="sr">[^@</span><span class="se">\s</span><span class="sr">]+@[^@</span><span class="se">\s</span><span class="sr">]+</span><span class="se">\z</span><span class="sr">/</span><span class="p" data-group-id="2854050193-4">)</span><span class="w">
  </span><span class="n">user_eq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Eq.Utils</span><span class="o">.</span><span class="n">contramap</span><span class="p" data-group-id="2854050193-5">(</span><span class="k" data-group-id="2854050193-6">fn</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="2854050193-7">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="p" data-group-id="2854050193-7">}</span><span class="w"> </span><span class="k" data-group-id="2854050193-6">end</span><span class="p" data-group-id="2854050193-5">)</span><span class="w">
  
  </span><span class="c1"># Curried operations</span><span class="w">
  </span><span class="n">validate_with</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Funx.Utils</span><span class="o">.</span><span class="n">curry_r</span><span class="p" data-group-id="2854050193-8">(</span><span class="k" data-group-id="2854050193-9">fn</span><span class="w"> </span><span class="n">predicate</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="nc">Predicate</span><span class="o">.</span><span class="n">test</span><span class="p" data-group-id="2854050193-10">(</span><span class="n">predicate</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p" data-group-id="2854050193-10">)</span><span class="w"> </span><span class="k" data-group-id="2854050193-11">do</span><span class="w">
      </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="2854050193-12">(</span><span class="n">value</span><span class="p" data-group-id="2854050193-12">)</span><span class="w">
    </span><span class="k" data-group-id="2854050193-11">else</span><span class="w">
      </span><span class="nc">Either</span><span class="o">.</span><span class="n">left</span><span class="p" data-group-id="2854050193-13">(</span><span class="s">&quot;validation failed&quot;</span><span class="p" data-group-id="2854050193-13">)</span><span class="w">
    </span><span class="k" data-group-id="2854050193-11">end</span><span class="w">
  </span><span class="k" data-group-id="2854050193-9">end</span><span class="p" data-group-id="2854050193-8">)</span><span class="w">
  
  </span><span class="n">transform_with</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Funx.Utils</span><span class="o">.</span><span class="n">curry_r</span><span class="p" data-group-id="2854050193-14">(</span><span class="k" data-group-id="2854050193-15">fn</span><span class="w"> </span><span class="n">transformer</span><span class="p">,</span><span class="w"> </span><span class="n">monad_value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="2854050193-16">(</span><span class="n">monad_value</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="2854050193-17">fn</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="2854050193-18">(</span><span class="n">transformer</span><span class="o">.</span><span class="p" data-group-id="2854050193-19">(</span><span class="n">value</span><span class="p" data-group-id="2854050193-19">)</span><span class="p" data-group-id="2854050193-18">)</span><span class="w">
    </span><span class="k" data-group-id="2854050193-17">end</span><span class="p" data-group-id="2854050193-16">)</span><span class="w">
  </span><span class="k" data-group-id="2854050193-15">end</span><span class="p" data-group-id="2854050193-14">)</span><span class="w">
  
  </span><span class="c1"># Build comprehensive validation pipeline</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">validate_and_transform_user</span><span class="p" data-group-id="2854050193-20">(</span><span class="n">user_data</span><span class="p">,</span><span class="w"> </span><span class="n">existing_users</span><span class="p" data-group-id="2854050193-20">)</span><span class="w"> </span><span class="k" data-group-id="2854050193-21">do</span><span class="w">
    </span><span class="n">user_data</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="2854050193-22">(</span><span class="p" data-group-id="2854050193-22">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="2854050193-23">(</span><span class="n">validate_with</span><span class="o">.</span><span class="p" data-group-id="2854050193-24">(</span><span class="n">age_predicate</span><span class="p" data-group-id="2854050193-24">)</span><span class="o">.</span><span class="p" data-group-id="2854050193-25">(</span><span class="n">user_data</span><span class="o">.</span><span class="n">age</span><span class="p" data-group-id="2854050193-25">)</span><span class="p" data-group-id="2854050193-23">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="2854050193-26">(</span><span class="n">validate_with</span><span class="o">.</span><span class="p" data-group-id="2854050193-27">(</span><span class="n">email_predicate</span><span class="p" data-group-id="2854050193-27">)</span><span class="o">.</span><span class="p" data-group-id="2854050193-28">(</span><span class="n">user_data</span><span class="o">.</span><span class="n">email</span><span class="p" data-group-id="2854050193-28">)</span><span class="p" data-group-id="2854050193-26">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">transform_with</span><span class="o">.</span><span class="p" data-group-id="2854050193-29">(</span><span class="k" data-group-id="2854050193-30">fn</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> 
      </span><span class="p" data-group-id="2854050193-31">%{</span><span class="n">data</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="o">.</span><span class="n">upcase</span><span class="p" data-group-id="2854050193-32">(</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p" data-group-id="2854050193-32">)</span><span class="p" data-group-id="2854050193-31">}</span><span class="w">
    </span><span class="k" data-group-id="2854050193-30">end</span><span class="p" data-group-id="2854050193-29">)</span><span class="o">.</span><span class="p" data-group-id="2854050193-33">(</span><span class="p" data-group-id="2854050193-33">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="2854050193-34">(</span><span class="k" data-group-id="2854050193-35">fn</span><span class="w"> </span><span class="n">processed_user</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="c1"># Check for duplicates using custom Eq</span><span class="w">
      </span><span class="n">duplicate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">find</span><span class="p" data-group-id="2854050193-36">(</span><span class="n">existing_users</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="2854050193-37">fn</span><span class="w"> </span><span class="n">existing</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="nc">Eq.Utils</span><span class="o">.</span><span class="n">eq?</span><span class="p" data-group-id="2854050193-38">(</span><span class="n">processed_user</span><span class="p">,</span><span class="w"> </span><span class="n">existing</span><span class="p">,</span><span class="w"> </span><span class="n">user_eq</span><span class="p" data-group-id="2854050193-38">)</span><span class="w">
      </span><span class="k" data-group-id="2854050193-37">end</span><span class="p" data-group-id="2854050193-36">)</span><span class="w">
      
      </span><span class="k">if</span><span class="w"> </span><span class="n">duplicate</span><span class="w"> </span><span class="k" data-group-id="2854050193-39">do</span><span class="w">
        </span><span class="nc">Either</span><span class="o">.</span><span class="n">left</span><span class="p" data-group-id="2854050193-40">(</span><span class="s">&quot;duplicate user&quot;</span><span class="p" data-group-id="2854050193-40">)</span><span class="w">
      </span><span class="k" data-group-id="2854050193-39">else</span><span class="w">
        </span><span class="nc">Either</span><span class="o">.</span><span class="n">right</span><span class="p" data-group-id="2854050193-41">(</span><span class="n">processed_user</span><span class="p" data-group-id="2854050193-41">)</span><span class="w">
      </span><span class="k" data-group-id="2854050193-39">end</span><span class="w">
    </span><span class="k" data-group-id="2854050193-35">end</span><span class="p" data-group-id="2854050193-34">)</span><span class="w">
  </span><span class="k" data-group-id="2854050193-21">end</span><span class="w">
  
  </span><span class="c1"># Usage</span><span class="w">
  </span><span class="n">new_user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="2854050193-42">%{</span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;alice&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">age</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="ss">email</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;alice@example.com&quot;</span><span class="p" data-group-id="2854050193-42">}</span><span class="w">
  </span><span class="n">existing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="2854050193-43">[</span><span class="p" data-group-id="2854050193-44">%{</span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="mi">456</span><span class="p">,</span><span class="w"> </span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bob&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">age</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="ss">email</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bob@example.com&quot;</span><span class="p" data-group-id="2854050193-44">}</span><span class="p" data-group-id="2854050193-43">]</span><span class="w">
  
  </span><span class="n">validate_and_transform_user</span><span class="p" data-group-id="2854050193-45">(</span><span class="n">new_user</span><span class="p">,</span><span class="w"> </span><span class="n">existing</span><span class="p" data-group-id="2854050193-45">)</span><span class="w">
</span><span class="k" data-group-id="2854050193-2">end</span></code></pre><h2 id="performance-considerations" class="section-heading">
  <a href="#performance-considerations" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Performance Considerations</span>
</h2>
<h3 id="protocol-overhead" class="section-heading">
  <a href="#protocol-overhead" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Protocol Overhead</span>
</h3>
<p>Protocol dispatch has performance overhead compared to direct module calls:</p><pre><code class="makeup elixir" translate="no"><span class="c1"># Benchmark protocol vs direct calls</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">benchmark_monad_operations</span><span class="p" data-group-id="7243508467-1">(</span><span class="p" data-group-id="7243508467-1">)</span><span class="w"> </span><span class="k" data-group-id="7243508467-2">do</span><span class="w">
  </span><span class="n">test_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="7243508467-3">(</span><span class="mi">42</span><span class="p" data-group-id="7243508467-3">)</span><span class="w">
  </span><span class="n">iterations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100_000</span><span class="w">
  
  </span><span class="c1"># Protocol version</span><span class="w">
  </span><span class="n">protocol_fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="7243508467-4">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="nc">Enum</span><span class="o">.</span><span class="n">reduce</span><span class="p" data-group-id="7243508467-5">(</span><span class="mi">1</span><span class="o">..</span><span class="n">iterations</span><span class="p">,</span><span class="w"> </span><span class="n">test_value</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="7243508467-6">fn</span><span class="w"> </span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="n">acc</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="n">acc</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Monad</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="7243508467-7">(</span><span class="k" data-group-id="7243508467-8">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">SpecificMonad</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="7243508467-9">(</span><span class="w">  </span><span class="c1"># Use constructor like Maybe.just(, Either.right(, etc.x + 1) end)</span><span class="w">
    </span><span class="k">end</span><span class="p" data-group-id="7243508467-9">)</span><span class="w">
  </span><span class="k" data-group-id="7243508467-8">end</span><span class="w">
  
  </span><span class="c1"># Direct version  </span><span class="w">
  </span><span class="n">direct_fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="7243508467-10">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="nc">Enum</span><span class="o">.</span><span class="n">reduce</span><span class="p" data-group-id="7243508467-11">(</span><span class="mi">1</span><span class="o">..</span><span class="n">iterations</span><span class="p">,</span><span class="w"> </span><span class="n">test_value</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="7243508467-12">fn</span><span class="w"> </span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="n">acc</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="n">acc</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">bind</span><span class="p" data-group-id="7243508467-13">(</span><span class="k" data-group-id="7243508467-14">fn</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Maybe</span><span class="o">.</span><span class="n">just</span><span class="p" data-group-id="7243508467-15">(</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="7243508467-15">)</span><span class="w"> </span><span class="k" data-group-id="7243508467-14">end</span><span class="p" data-group-id="7243508467-13">)</span><span class="w">
    </span><span class="k" data-group-id="7243508467-12">end</span><span class="p" data-group-id="7243508467-11">)</span><span class="w">
  </span><span class="k" data-group-id="7243508467-10">end</span><span class="w">
  
  </span><span class="p" data-group-id="7243508467-16">{</span><span class="n">protocol_time</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p" data-group-id="7243508467-16">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">:timer</span><span class="o">.</span><span class="n">tc</span><span class="p" data-group-id="7243508467-17">(</span><span class="n">protocol_fun</span><span class="p" data-group-id="7243508467-17">)</span><span class="w">
  </span><span class="p" data-group-id="7243508467-18">{</span><span class="n">direct_time</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p" data-group-id="7243508467-18">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">:timer</span><span class="o">.</span><span class="n">tc</span><span class="p" data-group-id="7243508467-19">(</span><span class="n">direct_fun</span><span class="p" data-group-id="7243508467-19">)</span><span class="w">
  
  </span><span class="n">overhead_percent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="7243508467-20">(</span><span class="n">protocol_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">direct_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="7243508467-20">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="w">
  </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="7243508467-21">(</span><span class="s">&quot;Protocol overhead: </span><span class="si" data-group-id="7243508467-22">#{</span><span class="n">overhead_percent</span><span class="si" data-group-id="7243508467-22">}</span><span class="s">%&quot;</span><span class="p" data-group-id="7243508467-21">)</span><span class="w">
</span><span class="k">end</span></code></pre><p>Use protocols when:</p><ul><li><strong>Genericity is valuable</strong>: Function works with multiple monad types</li><li><strong>Performance is acceptable</strong>: Not in critical hot paths  </li><li><strong>Code reuse matters</strong>: Avoiding duplication across monad types</li></ul><p>Use direct module calls when:</p><ul><li><strong>Performance is critical</strong>: Hot paths or tight loops</li><li><strong>Single monad type</strong>: Only working with one specific monad</li><li><strong>Simple operations</strong>: Basic transformations that don't benefit from genericity</li></ul><h2 id="anti-patterns" class="section-heading">
  <a href="#anti-patterns" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Anti-Patterns</span>
</h2>
<p>Avoid these common mistakes when working with the Monad protocol:</p><ul><li><strong>Mixing protocol and module calls</strong> in the same generic function</li><li><strong>Using specific constructors</strong> like <code class="inline">Maybe.just/1</code> in protocol-based code  </li><li><strong>Ignoring monad laws</strong> when implementing custom monads</li><li><strong>Overusing protocol</strong> when direct module calls would be more efficient</li><li><strong>Nested bind calls</strong> instead of chaining with pipe operator</li><li><strong>Not testing law compliance</strong> for custom monad implementations</li></ul><h2 id="when-to-use" class="section-heading">
  <a href="#when-to-use" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">When to Use</span>
</h2>
<p>Use the Monad protocol when you want to:</p><ul><li>Write generic functions that work with multiple monad types</li><li>Create reusable algorithms independent of specific monad implementation  </li><li>Build libraries that support various monadic computations</li><li>Ensure your code follows mathematical monad laws</li><li>Enable composition patterns that work across different contexts</li><li>Abstract over computational patterns (error handling, optional values, etc.)</li></ul><h2 id="built-in-behavior" class="section-heading">
  <a href="#built-in-behavior" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Built-in Behavior</span>
</h2>
<ul><li><strong>Protocol dispatch</strong>: Runtime type-based method selection</li><li><strong>Law enforcement</strong>: Implementations should satisfy monad laws</li><li><strong>Composition support</strong>: Operations designed for chaining and nesting</li><li><strong>Type flexibility</strong>: Works with any type implementing the protocol</li></ul><h2 id="summary" class="section-heading">
  <a href="#summary" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Summary</span>
</h2>
<p><a href="Funx.Monad.html"><code class="inline">Funx.Monad</code></a> provides the essential protocol for monadic programming in Elixir. It enables writing generic, reusable functions that work with any monadic type while preserving the mathematical properties that make monads reliable and composable.</p><p>The protocol supports three core operations - <code class="inline">bind</code>, <code class="inline">return</code>, and <code class="inline">join</code> - that together provide a foundation for functional composition patterns. When combined with other Funx modules like Utils, Predicate, and Eq, it enables powerful functional programming abstractions.</p><p><strong>Key Points</strong>:</p><ul><li><strong>Generic programming</strong>: Write functions that work with any monad</li><li><strong>Mathematical foundation</strong>: Based on category theory laws for reliability  </li><li><strong>Composition patterns</strong>: Chain computations while preserving context</li><li><strong>Cross-module integration</strong>: Combines with other Funx utilities</li><li><strong>Performance trade-offs</strong>: Consider overhead vs. genericity benefits</li><li><strong>Law compliance</strong>: Always verify implementations satisfy monad laws</li></ul><p><strong>Canon</strong>: Use for generic monadic algorithms, test law compliance, prefer direct modules for performance-critical code.</p>
</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="predicate-usage-rules.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Funx.Predicate Usage Rules
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="monad-identity-usage-rules.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Funx.Monad.Identity Usage Rules
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

          <span class="line">
            <a href="https://hex.pm/packages/funx/0.1.4" class="footer-hex-package">Hex Package</a>

            <a href="https://preview.hex.pm/preview/funx/0.1.4">Hex Preview</a>

              (<a href="https://preview.hex.pm/preview/funx/0.1.4/show/lib/monad/usage-rules.md">current file</a>)

          </span>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="funx.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.34.2) for the

          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
